<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>MariaDB Galera Cluster di Centos 7 - Portal Teknologi</title><meta name="description" content="MariaDB Galera Cluster merupakan cluster yang bersifat synchronous multi-master dan hanya tersedia di Linux yang memungkinkan untuk menjalankan mesin database"><meta name="generator" content="Publii Open-Source CMS for Static Site"><link rel="canonical" href="https://teknomid.com/mariadb-galera-cluster-di-centos-7/"><link rel="amphtml" href="https://teknomid.com/amp/mariadb-galera-cluster-di-centos-7/"><link rel="alternate" type="application/atom+xml" href="https://teknomid.com/feed.xml"><link rel="alternate" type="application/json" href="https://teknomid.com/feed.json"><meta property="og:title" content="MariaDB Galera Cluster di Centos 7 - Portal Teknologi "><meta property="og:image" content="https://teknomid.com/media/posts/234/db1.png"><meta property="og:site_name" content="Portal Teknologi"><meta property="og:description" content="MariaDB Galera Cluster merupakan cluster yang bersifat synchronous multi-master dan hanya tersedia di Linux yang memungkinkan untuk menjalankan mesin database"><meta property="og:url" content="https://teknomid.com/mariadb-galera-cluster-di-centos-7/"><meta property="og:type" content="article"><meta property="fb:app_id" content="800151050785537"><meta name="twitter:card" content="summary"><meta name="twitter:site" content="@Teknomid_com"><meta name="twitter:title" content="MariaDB Galera Cluster di Centos 7 - Portal Teknologi "><meta name="twitter:description" content="MariaDB Galera Cluster merupakan cluster yang bersifat synchronous multi-master dan hanya tersedia di Linux yang memungkinkan untuk menjalankan mesin database"><meta name="twitter:image" content="https://teknomid.com/media/posts/234/db1.png"><link rel="shortcut icon" href="https://teknomid.com/media/website/teknomid.icon-ico.ico" type="image/x-icon"><link rel="stylesheet" href="https://teknomid.com/assets/css/style.css?v=8c50a837e4c415ed8bb044dc6e1715d6"><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://teknomid.com/mariadb-galera-cluster-di-centos-7/"},"headline":"MariaDB Galera Cluster di Centos 7","datePublished":"2022-08-03T19:43","dateModified":"2022-08-21T02:29","image":{"@type":"ImageObject","url":"https://teknomid.com/media/posts/234/db1.png","height":373,"width":773},"description":"MariaDB Galera Cluster merupakan cluster yang bersifat synchronous multi-master dan hanya tersedia di Linux yang memungkinkan untuk menjalankan mesin database","author":{"@type":"Person","name":"Admin","url":"https://teknomid.com/authors/teknomid/"},"publisher":{"@type":"Organization","name":"Admin","logo":{"@type":"ImageObject","url":"https://teknomid.com/media/website/Teknomid-Logo-4.png","height":105,"width":360}}}</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-210304387-1"></script><script>window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-210304387-1');</script></head><body><amp-analytics config="https://www.googletagmanager.com/amp.json?id=GTM-WR3Q5HW&gtm.url=SOURCE_URL" data-credentials="include"></amp-analytics><header class="topbar" id="js-header"><div class="topbar__inner"><a class="logo" href="https://teknomid.com/"><img src="https://teknomid.com/media/website/Teknomid-Logo-4.png" alt="Portal Teknologi" width="360" height="105"></a><nav class="navbar"><button class="navbar__toggle" aria-label="Menu" aria-haspopup="true" aria-expanded="false"><span class="navbar__toggle-box"><span class="navbar__toggle-inner">Menu</span></span></button><ul class="navbar__menu"><li><a href="https://teknomid.com/" title="https://teknomid.com" target="_self">Home</a></li><li><a href="https://teknomid.com/tags/tutorial/" title="https://teknomid.com/tags/tutorial/" target="_self" rel="https://teknomid.com/tags/tutorial/">Tutorial</a></li><li><a href="https://teknomid.com/tags/applikasi/" title="https://teknomid.com/tags/applikasi/" target="_self" rel="https://teknomid.com/tags/applikasi/">Applikasi</a></li><li class="has-submenu"><a href="https://teknomid.com/tags/cloud/" title="https://teknomid.com/tags/cloud/" target="_self" rel="https://teknomid.com/tags/cloud/" aria-haspopup="true">Cloud</a><ul class="navbar__submenu level-2" aria-hidden="true"><li><a href="https://teknomid.com/tags/google/" title="https://teknomid.com/tags/google/" target="_self" rel="https://teknomid.com/tags/google/">Google</a></li><li><a href="https://teknomid.com/tags/aws/" title="https://teknomid.com/tags/aws/" target="_self" rel="https://teknomid.com/tags/aws/">Aws</a></li></ul></li><li class="has-submenu"><a href="https://teknomid.com/tags/operating-system/" title="https://teknomid.com/tags/operating-system/" target="_self" rel="https://teknomid.com/tags/operating-system/" aria-haspopup="true">Systems</a><ul class="navbar__submenu level-2" aria-hidden="true"><li><a href="https://teknomid.com/tags/linux/" title="https://teknomid.com/tags/linux/" target="_self" rel="https://teknomid.com/tags/linux/">Linux</a></li><li><a href="https://teknomid.com/tags/macos/" title="https://teknomid.com/tags/macOS/" target="_self" rel="https://teknomid.com/tags/macOS/">MacOS</a></li><li class="https://teknomid.com/tags/windows/"><a href="https://teknomid.com/tags/windows/" title="Windows" target="_self" rel="https://teknomid.com/tags/windows/">Windows</a></li></ul></li><li class="has-submenu"><a href="https://teknomid.com/tags/tech-and-gadget/" title="https://teknomid.com/tags/tech-gadgets/" target="_self" rel="https://teknomid.com/tags/tech-gadgets/" aria-haspopup="true">Tech &amp; Gadgets</a><ul class="navbar__submenu level-2" aria-hidden="true"><li><a href="https://teknomid.com/tags/handphone/" title="https://teknomid.com/tags/handphone/" target="_self" rel="https://teknomid.com/tags/handphone/">Handphone</a></li><li><a href="https://teknomid.com/tags/crypto/" title="https://teknomid.com/tags/crypto/" target="_self" rel="https://teknomid.com/tags/crypto/">Crypto</a></li><li><a href="https://teknomid.com/tags/laptop/" title="https://teknomid.com/tags/laptop/" target="_self" rel="https://teknomid.com/tags/laptop/">Laptop</a></li></ul></li></ul></nav></div></header><div class="content"><div class="infobar"><div class="infobar__update">Last Updated: <time datetime="2022-08-21T17:57">21 August 2022</time></div><div class="infobar__search"><form action="https://teknomid.com/search.html" class="search__form"><input class="search__input" type="search" name="q" placeholder="Search ..." aria-label="Search ..."> <button type="submit" class="search__button"><span>Submit</span></button></form></div></div><main class="main"><article class="post"><ol class="breadcrumbs" itemscope itemtype="https://schema.org/BreadcrumbList"><li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a itemprop="item" href="https://teknomid.com/"><span itemprop="name">Home</span></a><meta itemprop="position" content="1"></li>›<li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a itemscope itemtype="https://schema.org/WebPage" itemprop="item" itemid="https://teknomid.com/tags/tutorial/" href="https://teknomid.com/tags/tutorial/"><span itemprop="name">TUTORIAL</span></a><meta itemprop="position" content="2"></li>›<li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><span itemprop="name">MariaDB Galera Cluster di Centos 7</span><meta itemprop="position" content="3"></li></ol><figure class="post__featured-image"><img src="https://teknomid.com/media/posts/234/db1.png" srcset="https://teknomid.com/media/posts/234/responsive/db1-xs.png 300w, https://teknomid.com/media/posts/234/responsive/db1-sm.png 480w, https://teknomid.com/media/posts/234/responsive/db1-md.png 768w, https://teknomid.com/media/posts/234/responsive/db1-lg.png 1024w, https://teknomid.com/media/posts/234/responsive/db1-xl.png 1360w, https://teknomid.com/media/posts/234/responsive/db1-2xl.png 1600w" sizes="(max-width: 1600px) 100vw, 1600px" loading="eager" height="373" width="773" alt="Linux MariaDB"><figcaption>Linux MariaDB Linux MariaDB</figcaption></figure><header class="u-header post__header"><h1>MariaDB Galera Cluster di Centos 7</h1><div class="u-header__meta u-small"><div><a href="https://teknomid.com/authors/teknomid/" title="Admin">Admin</a> <time datetime="2022-08-03T19:43">3 August 2022 </time><a href="https://teknomid.com/tags/tutorial/" class="u-tag u-tag--1">TUTORIAL</a></div></div></header><div class="post__entry u-inner"><p>MariaDB Galera Cluster merupakan cluster yang bersifat synchronous multi-master dan hanya tersedia di Linux yang memungkinkan untuk menjalankan mesin database berbasis MariaDB yang bersifat:</p><div class="post__toc"><h3>Table of Contents</h3><ul><li><a href="#mcetoc_1g9hrmq9p4j">MariaDB Galera Cluster di Centos 7</a><ul><li><a href="#mcetoc_1g9hrmq9p4k">1. Lakukan update terhadap ketiga node Linux CentOS 7</a></li><li><a href="#mcetoc_1g9hrmq9p4l">2. Tambahkan MariaDB 10.3.14 repository di ketiga node Linux CentOS 7</a></li><li><a href="#mcetoc_1g9hrmq9p4m">3. Menginstall MariaDB Server dan Galera di semua node Linux CentOS 7</a></li><li><a href="#mcetoc_1g9hrmq9p4n">4. Setup MariaDB Galera Cluster di semua node</a></li><li><a href="#mcetoc_1g9hrmq9p4o">5. Start Galera Cluster di mesin galera-01.training.net</a></li><li><a href="#mcetoc_1g9hrmq9p4p">6. Start service MariaDB di semua node (galera-01, galera-02 dan galera-03)</a></li><li><a href="#mcetoc_1g9hrmq9p4q">7. Setting root password database MariaDB pada setiap node</a></li><li><a href="#mcetoc_1g9hrmq9p4r">8. Login sebagai root ke mesin MariaDB pada setiap node untuk melihat status wsrep_cluster_size</a></li><li><a href="#mcetoc_1g9hrmq9p4s">9. Verifikasi port untuk replikasi sudah aktif</a></li><li><a href="#mcetoc_1g9hrmq9p4t">10. Melakukan pengetesan replikasi</a></li></ul></li></ul></div><ul><li>mempunyai performance tinggi dengan latency yang rendah</li><li>mendukung high availability</li><li>mempunyai skalabilitas yang baik untuk memenuhi kebutuhan yang terus berkembang</li></ul><p>MariaDB Galera cluster pada saat ini hanya mendukung tipe penyimpanan XtraDB dan InnoDB saja, meskipun bisa juga untuk tipe MyISAM, tetapi masih dalam tahap eksperiment dan sebaiknya tidak digunakan untuk keperluan produki.</p><h4 id="mcetoc_1g9hrmq9p4j">MariaDB Galera Cluster di Centos 7</h4><p>Pada artikel ini akan dijelaskan bagaimana membangun MariaDB Galera Cluster 10.3 yang terdiri dari 3 nodes Linux CentOS 7. Ketiga nodes CentOS 7 tersebut diberikan IP address dan hostname sebagai berikut:</p><p>Baca Juga: <strong><em><a href="https://teknomid.com/mariadb-galera-cluster-di-centos-7/" title="MariaDB Galera Cluster di Centos 7">MariaDB Galera Cluster di Centos 7</a></em></strong></p><figure class="post__image"><img loading="lazy" src="https://teknomid.com/media/posts/234/Screenshot_10.png" sizes="(max-width: 48em) 100vw, 768px" srcset="https://teknomid.com/media/posts/234/responsive/Screenshot_10-xs.png 300w, https://teknomid.com/media/posts/234/responsive/Screenshot_10-sm.png 480w, https://teknomid.com/media/posts/234/responsive/Screenshot_10-md.png 768w, https://teknomid.com/media/posts/234/responsive/Screenshot_10-lg.png 1024w, https://teknomid.com/media/posts/234/responsive/Screenshot_10-xl.png 1360w, https://teknomid.com/media/posts/234/responsive/Screenshot_10-2xl.png 1600w" alt="Cluster Node" width="506" height="164"><figcaption><strong><em>Cluster Node</em></strong></figcaption></figure><p>Catatan: pada artikel ini dianggap 3 nodes Linux CentOS 7 sudah terinstall sehingga tidak dijelaskan kembali proses instalasinya. IP Address dan hostname yang diberikan hanya sebagai contoh, dan dapat diganti menyesuaikan kebutuhan.</p><div class="wp-container-1 wp-block-group"><h5 id="mcetoc_1g9hrmq9p4k"><strong>1. Lakukan update terhadap ketiga node Linux CentOS 7</strong></h5><p class="wp-block-group__inner-container">Terlebih dahulu kita lakukan update paket yang ada di sistem Linux CentOS 7 dengan perintah:</p><pre class="wp-block-preformatted">yum update</pre><figure class="post__image"><img loading="lazy" src="https://teknomid.com/media/posts/234/centos-7-update.png" sizes="(max-width: 48em) 100vw, 768px" srcset="https://teknomid.com/media/posts/234/responsive/centos-7-update-xs.png 300w, https://teknomid.com/media/posts/234/responsive/centos-7-update-sm.png 480w, https://teknomid.com/media/posts/234/responsive/centos-7-update-md.png 768w, https://teknomid.com/media/posts/234/responsive/centos-7-update-lg.png 1024w, https://teknomid.com/media/posts/234/responsive/centos-7-update-xl.png 1360w, https://teknomid.com/media/posts/234/responsive/centos-7-update-2xl.png 1600w" alt="Linux centos-7-update" width="889" height="604"><figcaption><strong><em>Linux centos-7-update</em></strong></figcaption></figure><div class="wp-container-2 wp-block-group"><div class="wp-block-group__inner-container"><h5 id="mcetoc_1g9hrmq9p4l"><strong>2. Tambahkan MariaDB 10.3.14 repository di ketiga node Linux CentOS 7</strong></h5><p>Tambahkan repository MariaDB 10.3.14 ke dalam Linux CentOS 7 dengan membuat file baru /etc/yum/repos.d/MariaDB.repo</p><p>Baca Juga: <strong><em><a href="https://teknomid.com/setting-up-ipsecl2tp-vpn-server-in-linux/" title="Setting Up IPsec/L2TP VPN Server in Linux">Setting Up IPsec/L2TP VPN Server in Linux</a></em></strong></p><pre class="wp-block-preformatted">nano /etc/yum.repos.d/MariaDB.repo</pre><p>Kemudian copy paste baris di bawah, dan simpan.</p><pre class="wp-block-preformatted">[mariadb]
name = MariaDB-10.3.14
baseurl=http://yum.mariadb.org/10.3.14/centos7-amd64
# alternative: baseurl=http://archive.mariadb.org/mariadb-10.3.14/yum/centos7-amd64
gpgkey=https://yum.mariadb.org/RPM-GPG-KEY-MariaDB
gpgcheck=1</pre><p>Kemudian jalankan perintah di bawah ini:</p><pre class="wp-block-preformatted">yum clean all</pre><p>Lakukan impoort MariaDB GPG Public Key untuk MariaDB repository</p><p>Baca Juga: <strong><em><a href="https://teknomid.com/memahami-dan-konfigurasi-lvm-di-centos-8/" title="Memahami dan Konfigurasi LVM di Centos 8">Memahami dan Konfigurasi LVM di Centos 8</a></em></strong></p><pre class="wp-block-preformatted">rpm --import https://yum.mariadb.org/RPM-GPG-KEY-MariaDB</pre></div></div><div class="wp-container-3 wp-block-group"><div class="wp-block-group__inner-container"><h5 id="mcetoc_1g9hrmq9p4m"><strong>3. Menginstall MariaDB Server dan Galera di semua node Linux CentOS 7</strong></h5><p>Perhatikan bahwa di sini kita menggunakan MariaDB versi 10.3.14. Jalankan perintah di bawah ini untuk mulai menginstall MariaDB dan Galera Cluster:</p><pre class="wp-block-preformatted">yum install -y mariadb-server galera</pre><figure class="post__image"><img loading="lazy" src="https://teknomid.com/media/posts/234/Centos-Install-MariaDB-Server-Galera-2.png" sizes="(max-width: 48em) 100vw, 768px" srcset="https://teknomid.com/media/posts/234/responsive/Centos-Install-MariaDB-Server-Galera-2-xs.png 300w, https://teknomid.com/media/posts/234/responsive/Centos-Install-MariaDB-Server-Galera-2-sm.png 480w, https://teknomid.com/media/posts/234/responsive/Centos-Install-MariaDB-Server-Galera-2-md.png 768w, https://teknomid.com/media/posts/234/responsive/Centos-Install-MariaDB-Server-Galera-2-lg.png 1024w, https://teknomid.com/media/posts/234/responsive/Centos-Install-MariaDB-Server-Galera-2-xl.png 1360w, https://teknomid.com/media/posts/234/responsive/Centos-Install-MariaDB-Server-Galera-2-2xl.png 1600w" alt="Linux MariaDB Install Galera" width="959" height="544"><figcaption><strong><em>Linux MariaDB Install Galera</em></strong></figcaption></figure><h5 id="mcetoc_1g9hrmq9p4n"><strong>4. Setup MariaDB Galera Cluster di semua node</strong></h5><p>Edit file konfigurasi MariaDB yang ada di node pertama (hostname <em>galera-01</em>).</p><pre class="wp-block-preformatted">nano /etc/my.cnf.d/server.cnf</pre><p>Tambahkan baris berikut pada bagian [galera] dan simpan perubahan.</p><pre class="wp-block-preformatted">[galera]
 #Mandatory settings
 wsrep_on=ON
 wsrep_provider=/usr/lib64/galera/libgalera_smm.so
 wsrep_cluster_address=gcomm://192.168.243.11,192.168.243.12,192.168.243.13
 binlog_format=row
 default_storage_engine=InnoDB
 innodb_autoinc_lock_mode=2</pre><figure class="post__image"><img loading="lazy" src="https://teknomid.com/media/posts/234/Galera-Configuration.png" sizes="(max-width: 48em) 100vw, 768px" srcset="https://teknomid.com/media/posts/234/responsive/Galera-Configuration-xs.png 300w, https://teknomid.com/media/posts/234/responsive/Galera-Configuration-sm.png 480w, https://teknomid.com/media/posts/234/responsive/Galera-Configuration-md.png 768w, https://teknomid.com/media/posts/234/responsive/Galera-Configuration-lg.png 1024w, https://teknomid.com/media/posts/234/responsive/Galera-Configuration-xl.png 1360w, https://teknomid.com/media/posts/234/responsive/Galera-Configuration-2xl.png 1600w" alt="Linux MariaDB Config Galera" width="959" height="544"><figcaption><strong><em>Linux MariaDB Config Galera</em></strong></figcaption></figure><div class="wp-container-4 wp-block-group"><div class="wp-block-group__inner-container"><p>Lakukan langkah (4) di semua node yang lain (<em>galera-02</em> dan <em>galera-03</em>)</p></div></div><div class="wp-container-5 wp-block-group"><div class="wp-block-group__inner-container"><h5 id="mcetoc_1g9hrmq9p4o"><strong>5. Start Galera Cluster di mesin <em>galera-01.training.net</em></strong></h5><p>Jalankan Galera Cluster di mesin <em>galera-01.training.net</em> dengan perintah:</p><pre class="wp-block-preformatted">galera_new_cluster</pre></div></div><div class="wp-container-6 wp-block-group"><div class="wp-block-group__inner-container"><h5 id="mcetoc_1g9hrmq9p4p"><strong>6. Start service MariaDB di semua node (<em>galera-01</em>, <em>galera-02</em> dan <em>galera-03</em>)</strong></h5><pre class="wp-block-preformatted">systemctl start mysql</pre><p>Jika service berhasil dijalankan, maka Galera Cluster seharusnya sudah sukses dikonfigurasi.</p><p>Baca Juga: <strong><em><a href="https://teknomid.com/cara-mengelola-file-log-dengan-logrotate-di-ubuntu-2004/" title="Cara Mengelola File Log dengan Logrotate di Ubuntu 20.04">Cara Mengelola File Log dengan Logrotate di Ubuntu 20.04</a></em></strong></p></div></div><div class="wp-container-7 wp-block-group"><div class="wp-block-group__inner-container"><h5 id="mcetoc_1g9hrmq9p4q"><strong>7. Setting <em>root </em>password database MariaDB pada setiap node</strong></h5><p>Lakukan perintah ini pada semua node, untuk memberikan password user <em>root </em>pada database MariaDB:</p><pre class="wp-block-preformatted">#mysql_secure_installation</pre></div></div><figure class="post__image"><img loading="lazy" src="https://teknomid.com/media/posts/234/Secure-MariaDB-Root-Password.png" sizes="(max-width: 48em) 100vw, 768px" srcset="https://teknomid.com/media/posts/234/responsive/Secure-MariaDB-Root-Password-xs.png 300w, https://teknomid.com/media/posts/234/responsive/Secure-MariaDB-Root-Password-sm.png 480w, https://teknomid.com/media/posts/234/responsive/Secure-MariaDB-Root-Password-md.png 768w, https://teknomid.com/media/posts/234/responsive/Secure-MariaDB-Root-Password-lg.png 1024w, https://teknomid.com/media/posts/234/responsive/Secure-MariaDB-Root-Password-xl.png 1360w, https://teknomid.com/media/posts/234/responsive/Secure-MariaDB-Root-Password-2xl.png 1600w" alt="Linux MariaDB Set Password user root pada database" width="959" height="814"><figcaption><strong><em>Linux MariaDB Set Password user root pada database</em></strong></figcaption></figure><h5 id="mcetoc_1g9hrmq9p4r"><strong>8. Login sebagai <em>root</em> ke mesin MariaDB pada setiap node untuk melihat status <em>wsrep_cluster_size</em></strong></h5><pre class="wp-block-preformatted">mysql -u root -p</pre><figure class="post__image"><img loading="lazy" src="https://teknomid.com/media/posts/234/wsrep_cluster_size-status.png" sizes="(max-width: 48em) 100vw, 768px" srcset="https://teknomid.com/media/posts/234/responsive/wsrep_cluster_size-status-xs.png 300w, https://teknomid.com/media/posts/234/responsive/wsrep_cluster_size-status-sm.png 480w, https://teknomid.com/media/posts/234/responsive/wsrep_cluster_size-status-md.png 768w, https://teknomid.com/media/posts/234/responsive/wsrep_cluster_size-status-lg.png 1024w, https://teknomid.com/media/posts/234/responsive/wsrep_cluster_size-status-xl.png 1360w, https://teknomid.com/media/posts/234/responsive/wsrep_cluster_size-status-2xl.png 1600w" alt="Linux MariaDB Status wsrep_cluster_size" width="903" height="574"><figcaption><strong><em>Linux MariaDB Status wsrep_cluster_size</em></strong></figcaption></figure><div class="wp-container-8 wp-block-group"><div class="wp-block-group__inner-container"><p>Dari gambar di atas, status dari <em>wsrep_cluster_size</em> menunjukkan bahwa semua node sudah terhubung ke dalam Galera Cluster.</p></div></div><div class="wp-container-9 wp-block-group"><div class="wp-block-group__inner-container"><h5 id="mcetoc_1g9hrmq9p4s"><strong>9. Verifikasi port untuk replikasi sudah aktif</strong></h5><p>Lakukan verifikasi port untuk replikasi dan pastikan sudah aktif (established):</p><pre class="wp-block-preformatted">lsof -i:4567</pre><figure class="post__image"><img loading="lazy" src="https://teknomid.com/media/posts/234/lsoft.png" sizes="(max-width: 48em) 100vw, 768px" srcset="https://teknomid.com/media/posts/234/responsive/lsoft-xs.png 300w, https://teknomid.com/media/posts/234/responsive/lsoft-sm.png 480w, https://teknomid.com/media/posts/234/responsive/lsoft-md.png 768w, https://teknomid.com/media/posts/234/responsive/lsoft-lg.png 1024w, https://teknomid.com/media/posts/234/responsive/lsoft-xl.png 1360w, https://teknomid.com/media/posts/234/responsive/lsoft-2xl.png 1600w" alt="Linux MariaDB Verifikasi Port Replikasi" width="687" height="346"><figcaption><strong><em>Linux MariaDB Verifikasi Port Replikasi</em></strong></figcaption></figure></div></div><div class="wp-container-10 wp-block-group"><div class="wp-block-group__inner-container"><h5 id="mcetoc_1g9hrmq9p4t"><strong>10. Melakukan pengetesan replikasi</strong></h5><p>Selanjutnya untuk melihat apakah replikasi dapat berjalan di semua node, kita akan mencoba untuk membuat sebuah database pada salah satu node (dalam hal ini dilakukan di node <em>galera-03</em>).</p><p>Database ini seharusnya juga secara otomatis akan dibuat di node yang lain (<em>galera-01</em> dan <em>galera-02</em>).</p><p>Baca Juga: <strong><em><a href="https://teknomid.com/cara-menghapus-cache-memori-ram-buffer-dan-swap-space-di-linux/" title="Cara Menghapus Cache Memori RAM, Buffer, dan Swap Space di Linux">Cara Menghapus Cache Memori RAM, Buffer, dan Swap Space di Linux</a></em></strong></p><pre class="wp-block-preformatted">mysql -u root -p</pre><figure class="post__image"><img loading="lazy" src="https://teknomid.com/media/posts/234/galera-01.png" sizes="(max-width: 48em) 100vw, 768px" srcset="https://teknomid.com/media/posts/234/responsive/galera-01-xs.png 300w, https://teknomid.com/media/posts/234/responsive/galera-01-sm.png 480w, https://teknomid.com/media/posts/234/responsive/galera-01-md.png 768w, https://teknomid.com/media/posts/234/responsive/galera-01-lg.png 1024w, https://teknomid.com/media/posts/234/responsive/galera-01-xl.png 1360w, https://teknomid.com/media/posts/234/responsive/galera-01-2xl.png 1600w" alt="Linux MariaDB Galera-01" width="687" height="423"><figcaption><strong><em>Linux MariaDB Galera-01</em></strong></figcaption></figure><figure class="post__image"><img loading="lazy" src="https://teknomid.com/media/posts/234/galera-02.png" sizes="(max-width: 48em) 100vw, 768px" srcset="https://teknomid.com/media/posts/234/responsive/galera-02-xs.png 300w, https://teknomid.com/media/posts/234/responsive/galera-02-sm.png 480w, https://teknomid.com/media/posts/234/responsive/galera-02-md.png 768w, https://teknomid.com/media/posts/234/responsive/galera-02-lg.png 1024w, https://teknomid.com/media/posts/234/responsive/galera-02-xl.png 1360w, https://teknomid.com/media/posts/234/responsive/galera-02-2xl.png 1600w" alt="Linux MariaDB Galera-02" width="687" height="297"><figcaption><strong><em>Linux MariaDB Galera-02</em></strong></figcaption></figure><figure class="post__image"><img loading="lazy" src="https://teknomid.com/media/posts/234/galera-03.png" sizes="(max-width: 48em) 100vw, 768px" srcset="https://teknomid.com/media/posts/234/responsive/galera-03-xs.png 300w, https://teknomid.com/media/posts/234/responsive/galera-03-sm.png 480w, https://teknomid.com/media/posts/234/responsive/galera-03-md.png 768w, https://teknomid.com/media/posts/234/responsive/galera-03-lg.png 1024w, https://teknomid.com/media/posts/234/responsive/galera-03-xl.png 1360w, https://teknomid.com/media/posts/234/responsive/galera-03-2xl.png 1600w" alt="Linux MariaDB Galera-03" width="687" height="346"><figcaption><strong><em>Linux MariaDB Galera-03</em></strong></figcaption></figure></div></div></div></div></div></div><aside class="post__aside"><div class="post__last-updated u-small">This article was updated on 21 August 2022</div><div class="post__share"><a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fteknomid.com%2Fmariadb-galera-cluster-di-centos-7%2F" class="js-share facebook" title="Share with Facebook" rel="nofollow noopener noreferrer" aria-label="Share with Facebook"><svg class="u-icon"><use xlink:href="https://teknomid.com/assets/svg/svg-map.svg#facebook"/></svg> </a><a href="https://twitter.com/share?url=https%3A%2F%2Fteknomid.com%2Fmariadb-galera-cluster-di-centos-7%2F&amp;via=teknomid&amp;text=MariaDB%20Galera%20Cluster%20di%20Centos%207" class="js-share twitter" title="Share with Twitter" rel="nofollow noopener noreferrer" aria-label="Share with Twitter"><svg class="u-icon"><use xlink:href="https://teknomid.com/assets/svg/svg-map.svg#twitter"/></svg> </a><a href="https://pinterest.com/pin/create/button/?url=https%3A%2F%2Fteknomid.com%2Fmariadb-galera-cluster-di-centos-7%2F&amp;media=https%3A%2F%2Fteknomid.com%2Fmedia%2Fposts%2F234%2Fdb1.png&amp;description=MariaDB%20Galera%20Cluster%20di%20Centos%207" class="js-share pinterest" title="Share with Pinterest" rel="nofollow noopener noreferrer" aria-label="Share with Pinterest"><svg class="u-icon"><use xlink:href="https://teknomid.com/assets/svg/svg-map.svg#pinterest"/></svg> </a><a href="https://wa.me/?text=MariaDB%20Galera%20Cluster%20di%20Centos%207 https%3A%2F%2Fteknomid.com%2Fmariadb-galera-cluster-di-centos-7%2F" class="js-share whatsapp" rel="nofollow noopener noreferrer" title="Share with WhatsApp" aria-label="Share with WhatsApp"><svg class="u-icon"><use xlink:href="https://teknomid.com/assets/svg/svg-map.svg#whatsapp"/></svg></a></div></aside><footer class="post__footer"><ul class="post__tag box"><li><a href="https://teknomid.com/tags/applikasi/" class="u-tag u-tag--1" title="Applikasi">Applikasi</a></li><li><a href="https://teknomid.com/tags/linux/" class="u-tag u-tag--1" title="LINUX">LINUX</a></li><li><a href="https://teknomid.com/tags/tutorial/" class="u-tag u-tag--1" title="TUTORIAL">TUTORIAL</a></li></ul><div class="post__bio box"><div><h4 class="h6"><a href="https://teknomid.com/authors/teknomid/" title="Admin">Admin</a></h4></div></div><nav class="post__nav box"><div class="post__nav__prev"><a href="https://teknomid.com/applikasi-android-f-droid/" class="post__nav__link" rel="prev"><img src="https://teknomid.com/media/posts/233/fdroid-logo-text_S0MUfk_FsnAYL7n2MQye-34IoSNm6QM6xYjDnMqkufo.svg" loading="lazy" alt="F-Droid" height="48" width="160"><div class="u-small">Previous Post<h5>Applikasi Android F-Droid </h5></div></a></div><div class="post__nav__next"><a href="https://teknomid.com/konfigurasi-strongswan-vpn-ipsec-ikev2-di-ubuntu-2004/" class="post__nav__link" rel="next"><div class="u-small">Next Post<h5>Konfigurasi Strongswan VPN IPSEC IKEV2 di Ubuntu 20.04</h5></div><img src="https://teknomid.com/media/posts/235/responsive/2022-08-10_080344-xs.png" loading="lazy" alt="Linux Strongswan VPN IPSEC" height="336" width="664"></a></div></nav><div class="post__related box"><h3 class="box__title">Related posts</h3><div class="post__related-wrap"><figure class="post__related-item"><a href="https://teknomid.com/memahami-dan-konfigurasi-lvm-di-centos-8/" class="c-card__image"><img src="https://teknomid.com/media/posts/199/responsive/Screen-Shot-2022-01-20-at-02.58.28-2-xs.png" loading="lazy" height="371" width="738" alt="LVM di Centos 8"></a><figcaption><h4 class="post__related-title"><a href="https://teknomid.com/memahami-dan-konfigurasi-lvm-di-centos-8/" class="inverse">Memahami dan Konfigurasi LVM di Centos 8</a></h4><time datetime="2022-01-20T03:34" class="u-small">20 January 2022</time></figcaption></figure></div></div></footer></article><div class="comments-area box"><div class="comments"><div class="comments-wrapper"><h4>Comments</h4><div id="cusdis_thread" data-host="https://cusdis.com" data-app-id="ac4c5cf2-d7b6-4538-98f4-54f04677de7e" data-page-id="234" data-page-url="https://teknomid.com/mariadb-galera-cluster-di-centos-7/" data-page-title="MariaDB Galera Cluster di Centos 7" data-theme="auto"></div><noscript>Please enable JS to use the comments form.</noscript><script type="text/javascript">var cusdis_element_to_check = document.getElementById('cusdis_thread');

				if ('IntersectionObserver' in window) {
					var iObserver = new IntersectionObserver(
						(entries, observer) => {
							entries.forEach(entry => {
								if (entry.intersectionRatio >= 0.1) {
									(function () {
										var d = document, s = d.createElement('script');
										s.defer = true;
										s.src = 'https://cusdis.com/js/cusdis.es.js';									
										(d.head || d.body).appendChild(s);
									})();
									observer.unobserve(entry.target);
								}
							});
						},
						{
							threshold: [0, 0.2, 0.5, 1]
						}
					);

					iObserver.observe(cusdis_element_to_check);
				} else {
					(function () {
						var d = document, s = d.createElement('script');
						s.defer = true;
						s.src = 'https://cusdis.com/js/cusdis.es.js';
						(d.head || d.body).appendChild(s);
					})();
				}</script><script type="text/javascript"></script></div></div></div></main><div class="sidebar"><section class="box featured"><h3 class="box__title">Featured</h3><ul class="featured__container"><li class="featured__item"><a href="https://teknomid.com/konfigurasi-strongswan-vpn-ipsec-ikev2-di-ubuntu-2004/" class="featured__image-link"><img src="https://teknomid.com/media/posts/235/responsive/2022-08-10_080344-xs.png" class="lazyload" loading="lazy" alt="Linux Strongswan VPN IPSEC" height="336" width="336"></a><div><a href="https://teknomid.com/konfigurasi-strongswan-vpn-ipsec-ikev2-di-ubuntu-2004/" class="featured__title">Konfigurasi Strongswan VPN IPSEC IKEV2 di Ubuntu 20.04</a> <time class="u-small" datetime="2022-08-04T03:14">4 August 2022</time></div></li><li class="featured__item"><a href="https://teknomid.com/mariadb-galera-cluster-di-centos-7/" class="featured__image-link"><img src="https://teknomid.com/media/posts/234/responsive/db1-xs.png" class="lazyload" loading="lazy" alt="Linux MariaDB" height="373" width="373"></a><div><a href="https://teknomid.com/mariadb-galera-cluster-di-centos-7/" class="featured__title">MariaDB Galera Cluster di Centos 7</a> <time class="u-small" datetime="2022-08-03T19:43">3 August 2022</time></div></li><li class="featured__item"><a href="https://teknomid.com/applikasi-android-f-droid/" class="featured__image-link"><img src="https://teknomid.com/media/posts/233/fdroid-logo-text_S0MUfk_FsnAYL7n2MQye-34IoSNm6QM6xYjDnMqkufo.svg" class="lazyload" loading="lazy" alt="F-Droid" height="48" width="48"></a><div><a href="https://teknomid.com/applikasi-android-f-droid/" class="featured__title">Applikasi Android F-Droid </a><time class="u-small" datetime="2022-08-03T00:33">3 August 2022</time></div></li><li class="featured__item"><a href="https://teknomid.com/tutorial-blokir-iklan-pada-android-tanpa-root/" class="featured__image-link"><img src="https://teknomid.com/media/posts/227/responsive/cara_memblokir_iklan_di_youtube-2xl-xs.jpg" class="lazyload" loading="lazy" alt="Tutorial Blokir Iklan Pada Android Tanpa Root" height="315" width="315"></a><div><a href="https://teknomid.com/tutorial-blokir-iklan-pada-android-tanpa-root/" class="featured__title">Tutorial Blokir Iklan Pada Android Tanpa Root</a> <time class="u-small" datetime="2022-07-28T00:20">28 July 2022</time></div></li><li class="featured__item"><a href="https://teknomid.com/pendatang-baru-nothing-phone-1/" class="featured__image-link"><img src="https://teknomid.com/media/posts/226/responsive/spesifikasi-nothing-phone-1-xs.jpg" class="lazyload" loading="lazy" alt="Pendatang Baru Nothing Phone" height="393" width="393"></a><div><a href="https://teknomid.com/pendatang-baru-nothing-phone-1/" class="featured__title">Pendatang Baru Nothing Phone (1)</a> <time class="u-small" datetime="2022-07-27T17:15">27 July 2022</time></div></li><li class="featured__item"><a href="https://teknomid.com/sangat-penting-untuk-logout-icloud-iphone/" class="featured__image-link"><img src="https://teknomid.com/media/posts/225/responsive/6.-Logout-iCloud-iPhone-Penting-Dilakukan-Simak-Langkah-Mudahnya-696x392-xs.jpg" class="lazyload" loading="lazy" alt="Sangat Penting Untuk Logout iCloud iPhone" height="392" width="392"></a><div><a href="https://teknomid.com/sangat-penting-untuk-logout-icloud-iphone/" class="featured__title">Sangat Penting Untuk Logout iCloud iPhone </a><time class="u-small" datetime="2022-07-27T03:02">27 July 2022</time></div></li><li class="featured__item"><a href="https://teknomid.com/tutorial-mengatasi-icloud-penuh-di-iphone/" class="featured__image-link"><img src="https://teknomid.com/media/posts/216/responsive/Cara-Mengatasi-iCloud-Penuh-di-Iphone-xs.jpg" class="lazyload" loading="lazy" alt="Tutorial Mengatasi iCloud Penuh di iPhone" height="408" width="408"></a><div><a href="https://teknomid.com/tutorial-mengatasi-icloud-penuh-di-iphone/" class="featured__title">Tutorial Mengatasi iCloud Penuh di iPhone</a> <time class="u-small" datetime="2022-07-27T02:32">27 July 2022</time></div></li><li class="featured__item"><a href="https://teknomid.com/unlock-dan-root-stb-indihome-zte-zxv10-b860h-tanpa-script-dan-bongkar/" class="featured__image-link"><img src="https://teknomid.com/media/posts/218/responsive/maxresdefault-xs.jpg" class="lazyload" loading="lazy" alt="utorial Unlock Dan Root STB  ZTE ZXV10 B860H" height="720" width="720"></a><div><a href="https://teknomid.com/unlock-dan-root-stb-indihome-zte-zxv10-b860h-tanpa-script-dan-bongkar/" class="featured__title">Tutorial Unlock Dan Root STB  ZTE ZXV10 B860H</a> <time class="u-small" datetime="2022-07-27T02:29">27 July 2022</time></div></li></ul></section><section class="box u-ads"><h3 class="u-ads__title">Advertisement</h3><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7286829343387415" crossorigin="anonymous"></script></section><section class="box"><h3 class="box__title">Follow us</h3><div class="follow"><a href="https://www.facebook.com/teknomidID/" class="facebook" aria-label="Facebook"><svg class="u-icon"><use xlink:href="https://teknomid.com/assets/svg/svg-map.svg#facebook"/></svg> Facebook </a><a href="https://twitter.com/Teknomid_com" class="twitter" aria-label="Twitter"><svg class="u-icon"><use xlink:href="https://teknomid.com/assets/svg/svg-map.svg#twitter"/></svg> Twitter </a><a href="https://id.pinterest.com/teknomid/" class="pinterest" aria-label="Pinterest"><svg class="u-icon"><use xlink:href="https://teknomid.com/assets/svg/svg-map.svg#pinterest"/></svg> Pinterest </a><a href="https://www.youtube.com/channel/UCmg7X0Q-1tZpL7oNau2_iJA" class="youtube" aria-label="Youtube"><svg class="u-icon"><use xlink:href="https://teknomid.com/assets/svg/svg-map.svg#youtube"/></svg> Youtube</a></div></section><section class="box authors"><h3 class="box__title">Authors</h3><ul class="authors__cotainer"><li class="authors__item"><div><a href="https://teknomid.com/authors/teknomid/" class="authors__title">Admin</a> <span class="u-small">Post: 50</span></div></li></ul></section><section class="box"><h3 class="box__title">Tags</h3><ul class="tags"><li><a href="https://teknomid.com/tags/applikasi/">Applikasi</a> <span class="u-small">(7)</span></li><li><a href="https://teknomid.com/tags/aws/">AWS</a> <span class="u-small">(2)</span></li><li><a href="https://teknomid.com/tags/cloud/">CLOUD</a> <span class="u-small">(4)</span></li><li><a href="https://teknomid.com/tags/elektronik/">ELEKTRONIK</a> <span class="u-small">(7)</span></li><li><a href="https://teknomid.com/tags/google/">GOOGLE</a> <span class="u-small">(3)</span></li><li><a href="https://teknomid.com/tags/handphone/">HANDPHONE</a> <span class="u-small">(12)</span></li><li><a href="https://teknomid.com/tags/laptop/">LAPTOP</a> <span class="u-small">(3)</span></li><li><a href="https://teknomid.com/tags/linux/">LINUX</a> <span class="u-small">(10)</span></li><li><a href="https://teknomid.com/tags/macos/">MacOS</a> <span class="u-small">(2)</span></li><li><a href="https://teknomid.com/tags/operating-system/">SYSTEMS</a> <span class="u-small">(5)</span></li></ul></section></div><footer class="footer"><a class="footer__logo" href="https://teknomid.com/"><img src="https://teknomid.com/media/website/Teknomid-Logo-4.png" alt="Portal Teknologi" width="360" height="105"></a><nav><ul class="footer__nav"></ul></nav><div class="footer__follow"><a href="https://www.facebook.com/teknomidID/" aria-label="Facebook"><svg><use xlink:href="https://teknomid.com/assets/svg/svg-map.svg#facebook"/></svg> </a><a href="https://twitter.com/Teknomid_com" aria-label="Twitter"><svg><use xlink:href="https://teknomid.com/assets/svg/svg-map.svg#twitter"/></svg> </a><a href="https://id.pinterest.com/teknomid/" aria-label="Pinterest"><svg><use xlink:href="https://teknomid.com/assets/svg/svg-map.svg#pinterest"/></svg> </a><a href="https://www.youtube.com/channel/UCmg7X0Q-1tZpL7oNau2_iJA" aria-label="Youtube"><svg><use xlink:href="https://teknomid.com/assets/svg/svg-map.svg#youtube"/></svg></a></div><div class="footer__copyright"><h6><span style="color: #e67e23;"><strong><a href="https://teknomid.com/tentang-2" title="About" target="_blank" rel="noopener" style="color: #e67e23;">About</a>  -  <a href="https://teknomid.com/kontak-2" title="Contact" target="_blank" rel="noopener" style="color: #e67e23;">Contact</a>  -  <a href="https://teknomid.com/kebijakan-privasi-2" title="Privacy" target="_blank" rel="noopener" style="color: #e67e23;">Privacy</a>  -  <a href="https://teknomid.com/disclaimer-2" title="Disclaimer" target="_blank" rel="noopener" style="color: #e67e23;">Disclaimer</a></strong></span></h6></div></footer></div><script>window.publiiThemeMenuConfig = {    
        mobileMenuMode: 'sidebar',
        animationSpeed: 300,
        submenuWidth: 'auto',
        doubleClickTime: 500,
        mobileMenuExpandableSubmenus: true, 
        relatedContainerForOverlayMenuSelector: '.navbar',
   };</script><script defer="defer" src="https://teknomid.com/assets/js/scripts.min.js?v=ef33954c8f912e6c18ee116825aadc90"></script><script>var images = document.querySelectorAll('img[loading]');

      for (var i = 0; i < images.length; i++) {
         if (images[i].complete) {
               images[i].classList.add('is-loaded');
         } else {
               images[i].addEventListener('load', function () {
                  this.classList.add('is-loaded');
               }, false);
         }
      }</script><div class="pcb" data-behaviour="badge" data-behaviour-link="#cookie-settings" data-revision="1" data-config-ttl="90" data-debug-mode="false"><div role="dialog" aria-modal="true" aria-hidden="true" aria-labelledby="pcb-title" aria-describedby="pcb-txt" class="pcb__banner pcb__banner--left"><div class="pcb__inner"><div id="pcb-title" role="heading" class="pcb__title">This website uses cookies</div><div id="pcb-txt" class="pcb__txt">Dengan menggunakan situs web kami, Anda dengan ini menyetujui Kebijakan Privasi kami. Thanks <a href="https://teknomid.com/privacy-policy/">Detail Kebijakan...</a></div><div class="pcb__buttons"><button type="button" class="pcb__btn pcb__btn--solid pcb__btn--accept">Save</button></div></div></div><button class="pcb__badge" aria-label="Cookie Policy" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" width="40" height="40" viewBox="0 0 23 23" fill="currentColor"><path d="M21.41 12.71c-.08-.01-.15 0-.22 0h-.03c-.03 0-.05 0-.08.01-.07 0-.13.01-.19.04-.52.21-1.44.19-2.02-.22-.44-.31-.65-.83-.62-1.53a.758.758 0 0 0-.27-.61.73.73 0 0 0-.65-.14c-1.98.51-3.49.23-4.26-.78-.82-1.08-.73-2.89.24-4.49.14-.23.14-.52 0-.75a.756.756 0 0 0-.67-.36c-.64.03-1.11-.1-1.31-.35-.19-.26-.13-.71-.01-1.29.04-.18.06-.38.03-.59-.05-.4-.4-.7-.81-.66C5.1 1.54 1 6.04 1 11.48 1 17.28 5.75 22 11.6 22c5.02 0 9.39-3.54 10.39-8.42.08-.4-.18-.78-.58-.87Zm-9.81 7.82c-5.03 0-9.12-4.06-9.12-9.06 0-4.34 3.05-8 7.25-8.86-.08.7.05 1.33.42 1.81.24.32.66.67 1.38.84-.76 1.86-.65 3.78.36 5.11.61.81 2.03 2 4.95 1.51.18.96.71 1.54 1.18 1.87.62.43 1.38.62 2.1.62.05 0 .09 0 .13-.01-1.23 3.64-4.7 6.18-8.64 6.18ZM13 17c0 .55-.45 1-1 1s-1-.45-1-1 .45-1 1-1 1 .45 1 1Zm5.29-12.3a.99.99 0 0 1-.29-.71c0-.55.45-.99 1-.99a1 1 0 0 1 .71.3c.19.19.29.44.29.71 0 .55-.45.99-1 .99a1 1 0 0 1-.71-.3ZM9 13.5c0 .83-.67 1.5-1.5 1.5S6 14.33 6 13.5 6.67 12 7.5 12s1.5.67 1.5 1.5Zm3.25.81a.744.744 0 0 1-.06-1.05c.28-.32.75-.34 1.05-.06.31.28.33.75.05 1.06-.15.16-.35.25-.56.25-.18 0-.36-.06-.5-.19ZM8.68 7.26c.41.37.44 1 .07 1.41-.2.22-.47.33-.75.33a.96.96 0 0 1-.67-.26c-.41-.37-.44-1-.07-1.41.37-.42 1-.45 1.41-.08Zm11.48 1.88c.18-.19.52-.19.7 0 .05.04.09.1.11.16.03.06.04.12.04.19 0 .13-.05.26-.15.35-.09.1-.22.15-.35.15s-.26-.05-.35-.15a.355.355 0 0 1-.11-.16.433.433 0 0 1-.04-.19c0-.13.05-.26.15-.35Zm-4.93-1.86a.75.75 0 1 1 1.059-1.06.75.75 0 0 1-1.059 1.06Z"/></svg></button></div><script>(function(win) {
    if (!document.querySelector('.pcb')) {
        return;
    }

    var cbConfig = {
        behaviour: document.querySelector('.pcb').getAttribute('data-behaviour'),
        behaviourLink: document.querySelector('.pcb').getAttribute('data-behaviour-link'),
        revision: document.querySelector('.pcb').getAttribute('data-revision'),
        configTTL: parseInt(document.querySelector('.pcb').getAttribute('data-config-ttl'), 10),
        debugMode: document.querySelector('.pcb').getAttribute('data-debug-mode') === 'true',
        initialState: null,
        previouslyAccepted: []
    };

    var cbUI = {
        wrapper: document.querySelector('.pcb'),
        banner: {
            element: null,
            btnAccept: null,
            btnReject: null,
            btnConfigure: null
        },
        popup: {
            element: null,
            btnClose: null,
            btnSave: null,
            btnAccept: null,
            btnReject: null,
            checkboxes: null,
        },
        overlay: null,
        badge: null,
        blockedScripts: document.querySelectorAll('script[type^="gdpr-blocker/"]'),
        triggerLinks: cbConfig.behaviourLink ? document.querySelectorAll('a[href*="' + cbConfig.behaviourLink + '"]') : null
    };

    function initUI () {
        // setup banner elements
        cbUI.banner.element = cbUI.wrapper.querySelector('.pcb__banner');
        cbUI.banner.btnAccept = cbUI.banner.element.querySelector('.pcb__btn--accept');
        cbUI.banner.btnReject = cbUI.banner.element.querySelector('.pcb__btn--reject');
        cbUI.banner.btnConfigure = cbUI.banner.element.querySelector('.pcb__btn--configure');

        // setup popup elements
        if (cbUI.wrapper.querySelector('.pcb__popup')) {
            cbUI.popup.element = cbUI.wrapper.querySelector('.pcb__popup');
            cbUI.popup.btnClose = cbUI.wrapper.querySelector('.pcb__popup__close');
            cbUI.popup.btnSave = cbUI.popup.element.querySelector('.pcb__btn--save');
            cbUI.popup.btnAccept = cbUI.popup.element.querySelector('.pcb__btn--accept');
            cbUI.popup.btnReject = cbUI.popup.element.querySelector('.pcb__btn--reject');
            cbUI.popup.checkboxes = cbUI.popup.element.querySelector('input[type="checkbox"]');
            // setup overlay
            cbUI.overlay = cbUI.wrapper.querySelector('.pcb__overlay');
        }

        cbUI.badge = cbUI.wrapper.querySelector('.pcb__badge');

        if (cbConfig.behaviour.indexOf('link') > -1) {
            for (var i = 0; i < cbUI.triggerLinks.length; i++) {
                cbUI.triggerLinks[i].addEventListener('click', function(e) {
                    e.preventDefault();
                    showBannerOrPopup();
                });
            }
        }
    }

    function initState () {
        var lsKeyName = getConfigName();
        var currentConfig = localStorage.getItem(lsKeyName);
        var configIsFresh = checkIfConfigIsFresh();

        if (!configIsFresh || currentConfig === null) {
            if (cbConfig.debugMode) {
                console.log('🍪 Config not found, or configuration expired');
            }

            showBanner();
        } else if (typeof currentConfig === 'string') {
            if (cbConfig.debugMode) {
                console.log('🍪 Config founded');
            }

            showBadge();

            if (cbUI.popup.element) {
                var allowedGroups = currentConfig.split(',');
                var checkedCheckboxes = cbUI.popup.element.querySelectorAll('input[type="checkbox"]:checked');

                for (var j = 0; j < checkedCheckboxes.length; j++) {
                    var name = checkedCheckboxes[j].getAttribute('data-group-name');

                    if (name && name !== '-' && allowedGroups.indexOf(name) === -1) {
                        checkedCheckboxes[j].checked = false;
                    }
                }

                for (var i = 0; i < allowedGroups.length; i++) {
                    var checkbox = cbUI.popup.element.querySelector('input[type="checkbox"][data-group-name="' + allowedGroups[i] + '"]');

                    if (checkbox) {
                        checkbox.checked = true;
                    }

                    allowCookieGroup(allowedGroups[i]);
                }
            }
        }

        setTimeout(function () {
            cbConfig.initialState = getInitialStateOfConsents();
        }, 0);
    }

    function checkIfConfigIsFresh () {
        var lastConfigSave = localStorage.getItem('publii-gdpr-cookies-config-save-date');

        if (lastConfigSave === null) {
            return false;
        }

        lastConfigSave = parseInt(lastConfigSave, 10);

        if (lastConfigSave === 0) {
            return true;
        }

        if (+new Date() - lastConfigSave < cbConfig.configTTL * 24 * 60 * 60 * 1000) {
            return true;
        }

        return false;
    }

    function initBannerEvents () {
        cbUI.banner.btnAccept.addEventListener('click', function (e) {
            e.preventDefault();
            acceptAllCookies('banner');
            showBadge();
        }, false);

        if (cbUI.banner.btnReject) {
            cbUI.banner.btnReject.addEventListener('click', function (e) {
                e.preventDefault();
                rejectAllCookies();
                showBadge();
            }, false);
        }

        if (cbUI.banner.btnConfigure) {
            cbUI.banner.btnConfigure.addEventListener('click', function (e) {
                e.preventDefault();
                hideBanner();
                showAdvancedPopup();
                showBadge();
            }, false);
        }
    }

    function initPopupEvents () {
        if (!cbUI.popup.element) {
            return;
        }

        cbUI.overlay.addEventListener('click', function (e) {
            hideAdvancedPopup();
        }, false);

        cbUI.popup.element.addEventListener('click', function (e) {
            e.stopPropagation();
        }, false);

        cbUI.popup.btnAccept.addEventListener('click', function (e) {
            e.preventDefault();
            acceptAllCookies('popup');
        }, false);

        cbUI.popup.btnReject.addEventListener('click', function (e) {
            e.preventDefault();
            rejectAllCookies();
        }, false);

        cbUI.popup.btnSave.addEventListener('click', function (e) {
            e.preventDefault();
            saveConfiguration();
        }, false);

        cbUI.popup.btnClose.addEventListener('click', function (e) {
            e.preventDefault();
            hideAdvancedPopup();
        }, false);
    }

    function initBadgeEvents () {
        if (!cbUI.badge) {
            return;
        }

        cbUI.badge.addEventListener('click', function (e) {
            showBannerOrPopup();
        }, false);
    }

    initUI();
    initState();
    initBannerEvents();
    initPopupEvents();
    initBadgeEvents();

    /**
     * API
     */
    function addScript (src, inline) {
        var newScript = document.createElement('script');

        if (src) {
            newScript.setAttribute('src', src);
        }

        if (inline) {
            newScript.text = inline;
        }

        document.body.appendChild(newScript);
    }

    function allowCookieGroup (allowedGroup) {
        var scripts = document.querySelectorAll('script[type="gdpr-blocker/' + allowedGroup + '"]');
        cbConfig.previouslyAccepted.push(allowedGroup);
    
        for (var j = 0; j < scripts.length; j++) {
            addScript(scripts[j].src, scripts[j].text);
        }

        var groupEvent = new Event('publii-cookie-banner-unblock-' + allowedGroup);
        document.body.dispatchEvent(groupEvent);
        unlockEmbeds(allowedGroup);

        if (cbConfig.debugMode) {
            console.log('🍪 Allowed group: ' + allowedGroup);
        }
    }

    function showBannerOrPopup () {
        if (cbUI.popup.element) {
            showAdvancedPopup();
        } else {
            showBanner();
        }
    }

    function showAdvancedPopup () {
        cbUI.popup.element.classList.add('is-visible');
        cbUI.overlay.classList.add('is-visible');
        cbUI.popup.element.setAttribute('aria-hidden', 'false');
        cbUI.overlay.setAttribute('aria-hidden', 'false');
    }

    function hideAdvancedPopup () {
        cbUI.popup.element.classList.remove('is-visible');
        cbUI.overlay.classList.remove('is-visible');
        cbUI.popup.element.setAttribute('aria-hidden', 'true');
        cbUI.overlay.setAttribute('aria-hidden', 'true');
    }

    function showBanner () {
        cbUI.banner.element.classList.add('is-visible');
        cbUI.banner.element.setAttribute('aria-hidden', 'false');
    }

    function hideBanner () {
        cbUI.banner.element.classList.remove('is-visible');
        cbUI.banner.element.setAttribute('aria-hidden', 'true');
    }

    function showBadge () {
        if (!cbUI.badge) {
            return;
        }

        cbUI.badge.classList.add('is-visible');
        cbUI.badge.setAttribute('aria-hidden', 'false');
    }

    function getConfigName () {
        var lsKeyName = 'publii-gdpr-allowed-cookies';

        if (cbConfig.revision) {
            lsKeyName = lsKeyName + '-v' + parseInt(cbConfig.revision, 10);
        }

        return lsKeyName;
    }

    function storeConfiguration (allowedGroups) {
        var lsKeyName = getConfigName();
        var dataToStore = allowedGroups.join(',');
        localStorage.setItem(lsKeyName, dataToStore);

        if (cbConfig.configTTL === 0) {
            localStorage.setItem('publii-gdpr-cookies-config-save-date', 0);

            if (cbConfig.debugMode) {
                console.log('🍪 Store never expiring configuration');
            }
        } else {
            localStorage.setItem('publii-gdpr-cookies-config-save-date', +new Date());
        }
    }

    function getInitialStateOfConsents () {
        if (!cbUI.popup.element) {
            return [];
        }

        var checkedGroups = cbUI.popup.element.querySelectorAll('input[type="checkbox"]:checked');
        var groups = [];

        for (var i = 0; i < checkedGroups.length; i++) {
            var allowedGroup = checkedGroups[i].getAttribute('data-group-name');

            if (allowedGroup !== '') {
                groups.push(allowedGroup);
            }
        }

        if (cbConfig.debugMode) {
            console.log('🍪 Initial state: ' + groups.join(', '));
        }

        return groups;
    }

    function getCurrentStateOfConsents () {
        if (!cbUI.popup.element) {
            return [];
        }

        var checkedGroups = cbUI.popup.element.querySelectorAll('input[type="checkbox"]:checked');
        var groups = [];

        for (var i = 0; i < checkedGroups.length; i++) {
            var allowedGroup = checkedGroups[i].getAttribute('data-group-name');

            if (allowedGroup !== '') {
                groups.push(allowedGroup);
            }
        }

        if (cbConfig.debugMode) {
            console.log('🍪 State to save: ' + groups.join(', '));
        }

        return groups;
    }

    function getAllGroups () {
        if (!cbUI.popup.element) {
            return [];
        }

        var checkedGroups = cbUI.popup.element.querySelectorAll('input[type="checkbox"]');
        var groups = [];

        for (var i = 0; i < checkedGroups.length; i++) {
            var allowedGroup = checkedGroups[i].getAttribute('data-group-name');

            if (allowedGroup !== '') {
                groups.push(allowedGroup);
            }
        }

        return groups;
    }

    function acceptAllCookies (source) {
        var groupsToAccept = getAllGroups();
        storeConfiguration(groupsToAccept);

        for (var i = 0; i < groupsToAccept.length; i++) {
            var group = groupsToAccept[i];

            if (cbConfig.initialState.indexOf(group) > -1 || cbConfig.previouslyAccepted.indexOf(group) > -1) {
                if (cbConfig.debugMode) {
                    console.log('🍪 Skip previously activated group: ' + group);
                }

                continue;
            }

            allowCookieGroup(group);
        }

        if (cbUI.popup.element) {
            var checkboxesToCheck = cbUI.popup.element.querySelectorAll('input[type="checkbox"]');

            for (var j = 0; j < checkboxesToCheck.length; j++) {
                checkboxesToCheck[j].checked = true;
            }
        }

        if (cbConfig.debugMode) {
            console.log('🍪 Accept all cookies: ', groupsToAccept.join(', '));
        }

        if (source === 'popup') {
            hideAdvancedPopup();
        } else if (source === 'banner') {
            hideBanner();
        }
    }

    function rejectAllCookies () {
        if (cbConfig.debugMode) {
            console.log('🍪 Reject all cookies');
        }

        storeConfiguration([]);
        setTimeout(function () {
            window.location.reload();
        }, 100);
    }

    function saveConfiguration () {
        var groupsToAccept = getCurrentStateOfConsents();
        storeConfiguration(groupsToAccept);

        if (cbConfig.debugMode) {
            console.log('🍪 Save new config: ', groupsToAccept.join(', '));
        }

        if (reloadIsNeeded(groupsToAccept)) {
            setTimeout(function () {
                window.location.reload();
            }, 100);
            return;
        }

        for (var i = 0; i < groupsToAccept.length; i++) {
            var group = groupsToAccept[i];

            if (cbConfig.initialState.indexOf(group) > -1 || cbConfig.previouslyAccepted.indexOf(group) > -1) {
                if (cbConfig.debugMode) {
                    console.log('🍪 Skip previously activated group: ' + group);
                }

                continue;
            }

            allowCookieGroup(group);
        }

        hideAdvancedPopup();
    }

    function reloadIsNeeded (groupsToAccept) {
        // check if user rejected consent for initial groups
        var initialGroups = cbConfig.initialState;
        var previouslyAcceptedGroups = cbConfig.previouslyAccepted;
        var groupsToCheck = initialGroups.concat(previouslyAcceptedGroups);

        for (var i = 0; i < groupsToCheck.length; i++) {
            var groupToCheck = groupsToCheck[i];

            if (groupsToAccept.indexOf(groupToCheck) === -1) {
                if (cbConfig.debugMode) {
                    console.log('🍪 Reload is needed due lack of: ', groupToCheck);
                }

                return true;
            }
        }

        return false;
    }

    function unlockEmbeds (cookieGroup) {
        var iframesToUnlock = document.querySelectorAll('.pec-wrapper[data-consent-group-id="' + cookieGroup + '"]');

        for (var i = 0; i < iframesToUnlock.length; i++) {
            var iframeWrapper = iframesToUnlock[i];
            iframeWrapper.querySelector('.pec-overlay').classList.remove('is-active');
            iframeWrapper.querySelector('.pec-overlay').setAttribute('aria-hidden', 'true');
            var iframe = iframeWrapper.querySelector('iframe');
            iframe.setAttribute('src', iframe.getAttribute('data-consent-src'));
        }
    }

    win.publiiEmbedConsentGiven = function (cookieGroup) {
        // it will unlock embeds
        allowCookieGroup(cookieGroup);

        var checkbox = cbUI.popup.element.querySelector('input[type="checkbox"][data-group-name="' + cookieGroup + '"]');

        if (checkbox) {
            checkbox.checked = true;
        }

        var groupsToAccept = getCurrentStateOfConsents();
        storeConfiguration(groupsToAccept);

        if (cbConfig.debugMode) {
            console.log('🍪 Save new config: ', groupsToAccept.join(', '));
        }
    }
})(window);</script></body></html>