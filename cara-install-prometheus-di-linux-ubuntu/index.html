<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-210304387-1"></script><script>window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-210304387-1');</script><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7286829343387415" crossorigin="anonymous"></script><script async custom-element="amp-auto-ads" src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js"></script><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Cara Install Prometheus di Linux Ubuntu - Portal Teknologi</title><meta name="description" content="Prometheus adalah sebuah sistem Monitoring opensource yang powerfull dimana tugasnya mengumpulkan metrik dari services dan menyimpannya dalam database time-s..."><meta name="generator" content="Publii Open-Source CMS for Static Site"><script type="gdpr-blocker/analytics" async src="https://www.googletagmanager.com/gtag/js?id=UA-210304387-1"></script><script type="gdpr-blocker/analytics">window.dataLayer = window.dataLayer || [];
				  function gtag(){dataLayer.push(arguments);}
				  gtag('js', new Date());
				  gtag('config', 'UA-210304387-1' , { 'anonymize_ip': true });
				  <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-210304387-1"></script><script>window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-210304387-1');</script><meta name="theme-color" content="#17181E" media="(prefers-color-scheme: dark)"><meta name="theme-color" content="#D73A42" media="(prefers-color-scheme: light)"><meta name="msapplication-navbutton-color" content="#D73A42"><meta name="apple-mobile-web-app-status-bar-style" content="#D73A42"><link rel="canonical" href="https://teknomid.com/cara-install-prometheus-di-linux-ubuntu/"><link rel="amphtml" href="https://teknomid.com/amp/cara-install-prometheus-di-linux-ubuntu/"><link rel="alternate" type="application/atom+xml" href="https://teknomid.com/feed.xml"><link rel="alternate" type="application/json" href="https://teknomid.com/feed.json"><meta property="og:title" content="Cara Install Prometheus di Linux Ubuntu - Portal Teknologi "><meta property="og:image" content="https://teknomid.com/media/posts/194/prometheus-696x279.webp"><meta property="og:site_name" content="Portal Teknologi"><meta property="og:description" content="Prometheus adalah sebuah sistem Monitoring opensource yang powerfull dimana tugasnya mengumpulkan metrik dari services dan menyimpannya dalam database time-s..."><meta property="og:url" content="https://teknomid.com/cara-install-prometheus-di-linux-ubuntu/"><meta property="og:type" content="article"><meta property="fb:app_id" content="800151050785537"><meta name="twitter:card" content="summary"><meta name="twitter:site" content="@Teknomid_com"><meta name="twitter:title" content="Cara Install Prometheus di Linux Ubuntu - Portal Teknologi "><meta name="twitter:description" content="Prometheus adalah sebuah sistem Monitoring opensource yang powerfull dimana tugasnya mengumpulkan metrik dari services dan menyimpannya dalam database time-s..."><meta name="twitter:image" content="https://teknomid.com/media/posts/194/prometheus-696x279.webp"><link rel="shortcut icon" href="https://teknomid.com/media/website/icon-teknomid-48x48.ico" type="image/x-icon"><link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin><link href="https://fonts.googleapis.com/css?family=Roboto+Condensed:400,700&amp;subset=latin-ext&amp;display=swap" rel="stylesheet"><style>:root{--body-font:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Fira Sans","Droid Sans","Helvetica Neue",Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol";--heading-font:'Roboto Condensed',sans-serif;--post-entry-font:var(--body-font);--logo-font:var(--heading-font);--menu-font:var(--heading-font)}</style><link rel="stylesheet" href="https://teknomid.com/assets/css/style.css?v=97212156f447e6f769705fde64db31e0"><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://teknomid.com/cara-install-prometheus-di-linux-ubuntu/"},"headline":"Cara Install Prometheus di Linux Ubuntu","datePublished":"2021-12-18T15:04","dateModified":"2022-08-04T04:37","image":{"@type":"ImageObject","url":"https://teknomid.com/media/posts/194/prometheus-696x279.webp","height":279,"width":696},"description":"Prometheus adalah sebuah sistem Monitoring opensource yang powerfull dimana tugasnya mengumpulkan metrik dari services dan menyimpannya dalam database time-s...","author":{"@type":"Person","name":"Teknomid","url":"https://teknomid.com/authors/teknomid/"},"publisher":{"@type":"Organization","name":"Teknomid","logo":{"@type":"ImageObject","url":"https://teknomid.com/media/website/Teknomid.png","height":570,"width":1961}}}</script><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7286829343387415" crossorigin="anonymous"></script><script id="mcjs">!function(c,h,i,m,p){m=c.createElement(h),p=c.getElementsByTagName(h)[0],m.async=1,m.src=i,p.parentNode.insertBefore(m,p)}(document,"script","https://chimpstatic.com/mcjs-connected/js/users/21f2909f5bb218342078a10dd/5fff7eb8961e991dc0f0f0437.js");</script></head><body><amp-auto-ads type="adsense" data-ad-client="ca-pub-7286829343387415"></amp-auto-ads><amp-analytics config="https://www.googletagmanager.com/amp.json?id=GTM-WR3Q5HW&gtm.url=SOURCE_URL" data-credentials="include"></amp-analytics><header class="topbar" id="js-header"><div class="topbar__inner"><a class="logo" href="https://teknomid.com/"><img src="https://teknomid.com/media/website/Teknomid.png" alt="Portal Teknologi"></a><nav class="navbar"><button class="navbar__toggle" aria-label="Menu" aria-haspopup="true" aria-expanded="false"><span class="navbar__toggle-box"><span class="navbar__toggle-inner">Menu</span></span></button><ul class="navbar__menu"><li><a href="https://teknomid.com/" title="https://teknomid.click" target="_self">Home</a></li><li class="has-submenu"><a href="https://teknomid.com/tags/tutorial/" title="https://teknomid.online/tags/tutorial/" target="_self" aria-haspopup="true">Tutorial</a><ul class="navbar__submenu level-2" aria-hidden="true"><li><a href="https://teknomid.com/" target="_self">SysADMIN</a></li></ul></li><li class="has-submenu"><a href="https://teknomid.com/tags/cloud/" title="https://teknomid.online/tags/cloud/" target="_self" aria-haspopup="true">Cloud</a><ul class="navbar__submenu level-2" aria-hidden="true"><li><a href="https://teknomid.com/tags/google/" title="https://teknomid.online/tags/google/" target="_self">Google</a></li><li><a href="https://teknomid.com/tags/aws/" title="https://teknomid.online/tags/aws/" target="_self">Aws</a></li></ul></li><li class="has-submenu"><a href="https://teknomid.com/tags/operating-system/" title="https://teknomid.online/tags/operating-system/" target="_self" aria-haspopup="true">Systems</a><ul class="navbar__submenu level-2" aria-hidden="true"><li><a href="https://teknomid.com/tags/linux/" title="https://teknomid.online/tags/linux/" target="_self" rel="https://teknomid.online/tags/linux/">Linux</a></li><li><a href="https://teknomid.com/tags/macos/" title="https://teknomid.online/tags/macOS/" target="_self" rel="https://teknomid.online/tags/macOS/">MacOS</a></li><li class="https://teknomid.online/tags/windows/"><a href="https://teknomid.com/tags/windows/" title="Windows" target="_self" rel="https://teknomid.online/tags/windows/">Windows</a></li></ul></li><li class="has-submenu"><a href="https://teknomid.com/tags/applikasi/" title="https://teknomid.online/tags/applikasi/" target="_self" aria-haspopup="true">Applikasi</a><ul class="navbar__submenu level-2" aria-hidden="true"><li><a href="https://teknomid.com/tags/mobile-applikasi/" title="https://teknomid.online/tags/mobile-applikasi/" target="_self" rel="https://teknomid.online/tags/appmobile/">App-Mobile</a></li><li><a href="https://teknomid.com/tags/windows-applikasi/" title="https://teknomid.online/tags/windows-applikasi/" target="_self" rel="https://teknomid.online/tags/appwindows/">App-Windows</a></li><li><a href="https://teknomid.com/tags/linux-applikasi/" title="https://teknomid.online/tags/linux-applikasi/" target="_self" rel="https://teknomid.online/tags/applinux/">App-Linux</a></li><li><a href="https://teknomid.com/tags/linux-applikasi/" title="https://teknomid.online/tags/macos-applikasi/" target="_self" rel="https://teknomid.online/tags/appmacos/">App-MacOS</a></li></ul></li><li class="has-submenu"><a href="https://teknomid.com/tags/tech-gadgets/" title="https://teknomid.online/tags/tech-gadgets/" target="_self" aria-haspopup="true">Tech &amp; Gadgets</a><ul class="navbar__submenu level-2" aria-hidden="true"><li><a href="https://teknomid.com/tags/handphone/" title="https://teknomid.online/tags/handphone/" target="_self">Handphone</a></li><li><a href="https://teknomid.com/tags/elektronik/" title="https://teknomid.online/tags/elektronik/" target="_self" rel="Elektronika">Elektronika</a></li><li><a href="https://teknomid.com/" title="https://teknomid.click" target="_self" rel="Crypto">Crypto</a></li><li><a href="https://teknomid.com/tags/laptop/" title="https://teknomid.com/tags/laptop/" target="_self" rel="Laptop">Laptop</a></li></ul></li></ul></nav></div></header><div class="content"><div class="infobar"><div class="infobar__update">Last Updated: <time datetime="2022-08-07T02:05">7 August 2022</time></div><form action="https://teknomid.com/search.html" class="search__form"><input class="search__input" type="search" name="q" placeholder="Cari..." aria-label="Cari..." autofocus> <button type="submit" class="search__button"><span>Submit</span></button></form></div><main class="main main--full"><article class="post"><figure class="post__featured-image"><img src="https://teknomid.com/media/posts/194/prometheus-696x279.webp" srcset="https://teknomid.com/media/posts/194/responsive/prometheus-696x279-xs.webp 300w, https://teknomid.com/media/posts/194/responsive/prometheus-696x279-sm.webp 480w, https://teknomid.com/media/posts/194/responsive/prometheus-696x279-md.webp 768w, https://teknomid.com/media/posts/194/responsive/prometheus-696x279-lg.webp 1024w, https://teknomid.com/media/posts/194/responsive/prometheus-696x279-xl.webp 1360w, https://teknomid.com/media/posts/194/responsive/prometheus-696x279-2xl.webp 1600w" sizes="(max-width: 1600px) 100vw, 1600px" loading="eager" height="279" width="696" alt="Cara Install Prometheus di Linux Ubuntu"><figcaption>Cara Install Prometheus di Linux Ubuntu Teknomid</figcaption></figure><header class="u-header post__header"><h1>Cara Install Prometheus di Linux Ubuntu</h1><div class="u-header__meta u-small"><div><a href="https://teknomid.com/authors/teknomid/" title="Teknomid">Teknomid</a> <time datetime="2021-12-18T15:04">18 December 2021 </time><a href="https://teknomid.com/tags/tutorial/" class="u-tag u-tag--1">TUTORIAL</a></div></div></header><div class="post__entry u-inner"><h4 id="mcetoc_1for77nn63pp">Pengantar</h4><p><a href="https://prometheus.io/" target="_blank" rel="noreferrer noopener">Prometheus </a>adalah sebuah sistem Monitoring opensource yang powerfull dimana tugasnya mengumpulkan metrik dari services dan menyimpannya dalam database time-series. Ini menawarkan model data multi-dimensi, bahasa kueri yang fleksibel, dan kemungkinan visualisasi yang beragam melalui applikasi web seperti Grafana.</p><div class="post__toc"><h3>Table of Contents</h3><ul><li><a href="#mcetoc_1for77nn63pp">Pengantar</a></li><li><a href="#mcetoc_1for77nn63pq">Beberapa pilihan yang paling populer meliputi:</a><ul><li><a href="#mcetoc_1for77nn63pr">Step 1 - Membuat User Service</a></li><li><a href="#mcetoc_1for77nn63ps">Step 2 - Downloading Prometheus</a></li><li><a href="#mcetoc_1for77nn63pt">Step 3 - Configuring Prometheus</a></li><li><a href="#mcetoc_1for77nn63pu">Step 4 - Running Prometheus</a></li></ul></li></ul></div><p> </p><p>Secara default, Prometheus hanya mengekspor metrik tentang dirinya sendiri (misalnya jumlah permintaan yang diterima, konsumsi memorinya, dll.). Namun, Anda dapat memperluas Prometheus dengan menginstal exporters, program opsional yang menghasilkan metrik tambahan.</p><p>Exporters - baik yang official yang dikelola oleh tim Prometheus maupun yang dikontribusikan oleh komunitas - memberikan informasi tentang segala hal mulai dari infrastruktur, database, dan server web hingga sistem messanging, API, dan banyak lagi.</p><h4 id="mcetoc_1for77nn63pq">Beberapa pilihan yang paling populer meliputi:</h4><ul><li><a href="https://prometheus.io/download/#node_exporter" target="_blank" rel="noreferrer noopener">node_exporter</a> - Ini menghasilkan metrik tentang infrastruktur, termasuk CPU saat ini, penggunaan memori dan disk, serta statistik I/O dan jaringan, seperti jumlah byte yang dibaca dari disk atau beban rata-rata server.</li><li><a href="https://prometheus.io/download/#blackbox_exporter" target="_blank" rel="noreferrer noopener">blackbox_exporter</a> - Ini menghasilkan metrik yang berasal dari protokol pemeriksaan seperti HTTP dan HTTPS untuk menentukan ketersediaan titik akhir, waktu respons, dan banyak lagi.</li><li><a href="https://prometheus.io/download/#mysqld_exporter" target="_blank" rel="noreferrer noopener">mysqld_exporter</a> - Ini mengumpulkan metrik yang terkait dengan server MySQL, seperti jumlah kueri yang dieksekusi, waktu respons kueri rata-rata, dan status replikasi cluster.</li><li>rabbitmq_exporter - Ini menampilkan metrik tentang sistem pesan RabbitMQ, termasuk jumlah pesan yang diterbitkan, jumlah pesan yang siap dikirim, dan ukuran semua pesan dalam antrian.</li><li>nginx-vts-exporter - Ini menyediakan metrik tentang server web Nginx menggunakan modul Nginx VTS, termasuk jumlah koneksi terbuka, jumlah respons yang dikirim (dikelompokkan berdasarkan kode respons), dan ukuran total permintaan yang dikirim atau diterima dalam byte .</li></ul><p>Lebih lengkapnya bisa di lihat dari <a href="https://prometheus.io/docs/instrumenting/exporters/" target="_blank" rel="noreferrer noopener">Prometheus</a>.</p><h5 id="mcetoc_1for77nn63pr">Step 1 - Membuat User Service</h5><p>Untuk tujuan keamanan, kita akan mulai dengan membuat dua Account User baru, prometheus dan node_exporter. Kita akan menggunakan akun ini sepanjang tutorial untuk mengisolasi Ownership pada file dan direktori Core Prometheus.</p><p>Create dua user ini, dan gunakan opsi <strong>--no-create-home </strong>dan <strong>--shell /bin/false</strong> sehingga User ini tidak dapat Login ke server dan tugasnya hanya untuk service-service yang di peuntukkan saja.</p><pre>sudo useradd --no-create-home --shell /bin/false prometheus <br>sudo useradd --no-create-home --shell /bin/false node_exporter</pre><p>Sebelum kita mengunduh binari Prometheus, buat direktori yang diperlukan untuk menyimpan file dan data Prometheus. Mengikuti konvensi standar Linux, kita akan membuat direktori di <strong>/etc</strong> untuk file konfigurasi Prometheus dan direktori di <strong>/var/lib</strong> untuk datanya.</p><pre>sudo mkdir /etc/prometheus <br>sudo mkdir /var/lib/prometheus</pre><p>Sekarang, atur ownership user dan grup pada direktori baru ke user prometheus.</p><pre>sudo chown prometheus:prometheus /etc/prometheus<br>sudo chown prometheus:prometheus /var/lib/prometheus</pre><h5 id="mcetoc_1for77nn63ps">Step 2 - Downloading Prometheus</h5><p>Setelah membuat ownership pada directory, kita sekarang dapat mengunduh Prometheus dan kemudian membuat file konfigurasi minimal untuk menjalankan Prometheus untuk pertama kalinya.</p><pre>cd ~<br>curl -LO https://github.com/prometheus/prometheus/releases/download/<br>v2.32.0/prometheus-2.32.0.linux-amd64.tar.gz</pre><p>Selanjutnya, gunakan perintah sha256sum untuk menghasilkan checksum dari file yang diunduh:</p><pre>sha256sum prometheus-2.32.0.linux-amd64.tar.gz</pre><p>Bandingkan output dari perintah ini dengan checksum pada halaman unduhan Prometheus untuk memastikan bahwa file Anda asli dan tidak rusak.</p><pre>Output:<br><br>e12917b25b32980daee0e9cf879d9ec197e2893924bd1574604eb0f550034d46<br>prometheus-2.32.0.linux-amd64.tar.gz</pre><p>Jika checksum tidak cocok, hapus file yang diunduh dan ulangi langkah sebelumnya untuk mengunduh ulang file.</p><p>Sekarang, buka paket arsip yang diunduh.</p><pre>tar xvf rometheus-2.32.0.linux-amd64.tar.gz</pre><p>Ini akan membuat direktori bernama rometheus-2.32.0.linux-amd64 yang berisi dua file biner (prometheus dan promtool), direktori consoles dan console_libraries yang berisi file antarmuka web, lisensi, pemberitahuan, dan beberapa file contoh.</p><p>Salin dua binari ke direktori <strong>/usr/local/bin.</strong></p><pre>sudo cp rometheus-2.32.0.linux-amd64/prometheus /usr/local/bin/<br>sudo cp rometheus-2.32.0.linux-amd64/promtool /usr/local/bin/</pre><p>Tetapkan Ownership user dan grup pada binari ke user <strong>prometheus</strong> yang dibuat pada Step 1.</p><pre>sudo chown prometheus:prometheus /usr/local/bin/prometheus<br>sudo chown prometheus:prometheus /usr/local/bin/promtool</pre><p>Tetapkan user and group ownership pada direktori ke user prometheus. Menggunakan flag -R akan memastikan bahwa ownership juga diatur pada file di dalam direktori.</p><pre>sudo chown -R prometheus:prometheus /etc/prometheus/consoles<br>sudo chown -R prometheus:prometheus /etc/prometheus/console_libraries</pre><p>Terakhir, hapus file hasil unduhan di home atau tempat unduhan Anda, karena tidak lagi diperlukan.</p><pre>rm -rf prometheus-2.32.0.linux-amd64.tar.gz prometheus-2.32.0.linux-amd64</pre><p>Sekarang setelah Prometheus terinstal, kita akan membuat file konfigurasi dan service sebagai persiapan untuk menjalankannya pertama kalinya.</p><h5 id="mcetoc_1for77nn63pt">Step 3 - Configuring Prometheus</h5><p>Di direktori /etc/prometheus, gunakan nano atau editor teks favorit Anda untuk membuat file konfigurasi bernama prometheus.yml. Untuk saat ini, file ini hanya berisi informasi yang cukup untuk menjalankan Prometheus untuk pertama kalinya.</p><pre>sudo nano /etc/prometheus/prometheus.yml<br><br>Peringatan: File konfigurasi Prometheus menggunakan format YAML,<br>yang secara ketat melarang tab dan membutuhkan "dua spasi"<br>untuk indentasi. Prometheus akan gagal untuk menjalankan service<br>jika file konfigurasi tidak sesuai dengan format YAML</pre><p>Dalam pengaturan global, tentukan interval default untuk metrik scraping. Perhatikan bahwa Prometheus akan menerapkan pengaturan ini ke setiap exporter kecuali pengaturan masing-masing exporter sendiri.</p><pre>Prometheus config file - /etc/prometheus/prometheus.yml<br>global:<br>scrape_interval: 15s<br><br>scrape_configs:<br>- job_name: 'prometheus'<br>scrape_interval: 5s<br>static_configs:<br>- targets: ['localhost:9090']</pre><p>Simpan file dan keluar dari editor teks Anda.</p><p>Sekarang, atur user and group ownership pada file konfigurasi ke user <strong>prometheus</strong> yang dibuat pada Step 1.</p><pre>sudo chown prometheus:prometheus /etc/prometheus/prometheus.yml</pre><h5 id="mcetoc_1for77nn63pu">Step 4 - Running Prometheus</h5><p>Mulai Prometheus dengan user prometheus, menyediakan jalur ke file konfigurasi dan direktori data.</p><pre>sudo -u prometheus /usr/local/bin/prometheus \<br>--config.file /etc/prometheus/prometheus.yml \<br>--storage.tsdb.path /var/lib/prometheus/ \<br>--web.console.templates=/etc/prometheus/consoles \<br>--web.console.libraries=/etc/prometheus/console_libraries</pre><p>Output berisi informasi tentang Loading Progress Prometheus, file konfigurasi, dan service terkait. Itu juga menegaskan bahwa Prometheus Listen pada port 9090.</p><pre>Output level=info ts=2017-11-17T18:37:27.474530094Z <br>caller=main.go:215 msg="Starting Prometheus" <br>version="(version=2.0.0, branch=HEAD, <br>re vision=0a74f98628a0463dddc90528220c94de5032d1a0)"<br>level=info ts=2017-11-17T18:37:27.474758404Z <br>caller=main.go:216 build_context="(go=go1.9.2, <br>user=root@615b82cb36b6, date=20171108- 07:11:59)"<br>level=info ts=2017-11-17T18:37:27.474883982Z <br>caller=main.go:217 host_details=<br>"(Linux 4.4.0-98-generic #121-Ubuntu SMP Tue Oct <br>10 1 4:24:03 UTC 2017 x86_64 prometheus-update (none))"<br>level=info ts=2017-11-17T18:37:27.483661837Z <br>caller=web.go:380 component=web msg="Start <br>listening for connections" address=0.0.0.0 :9090<br>level=info ts=2017-11-17T18:37:27.489730138Z <br>caller=main.go:314 msg="Starting TSDB"<br>level=info ts=2017-11-17T18:37:27.516050288Z <br>caller=targetmanager.go:71 component="target <br>manager" msg="Starting target manager... "<br>level=info ts=2017-11-17T18:37:27.537629169Z <br>caller=main.go:326 msg="TSDB started"<br>level=info ts=2017-11-17T18:37:27.537896721Z <br>caller=main.go:394 msg="Loading configuration <br>file" filename=/etc/prometheus/promethe us.yml<br>level=info ts=2017-11-17T18:37:27.53890004Z <br>caller=main.go:371 msg="Server is <br>ready to receive requests."</pre><p>Jika Anda mendapatkan pesan error, periksa kembali apakah Anda telah menggunakan sintaks YAML di file konfigurasi Anda, lalu ikuti petunjuk di layar untuk menyelesaikan masalah.</p><p>Sekarang, hentikan Prometheus dengan menekan <strong>CTRL+C</strong>, lalu create file service systemd baru.</p><pre>sudo nano /etc/systemd/system/prometheus.service</pre><p>File service memberi tahu systemd untuk menjalankan Prometheus sebagai pengguna prometheus, dengan file konfigurasi terletak di direktori <strong>/etc/prometheus/prometheus.yml</strong> dan untuk menyimpan datanya di direktori <strong>/var/lib/prometheus</strong>. (Rincian file service systemd berada di luar cakupan tutorial ini, tetapi Anda dapat mempelajari lebih lanjut di Memahami Unit Systemd dan File Unit.)</p><p>Salin konten berikut ke dalam file: <strong>/etc/systemd/system/prometheus.service</strong></p><pre>[Unit]<br>Description=Prometheus<br>Wants=network-online.target<br>After=network-online.target<br><br><br>[Service]<br>User=prometheus<br>Group=prometheus<br>Type=simple<br>ExecStart=/usr/local/bin/prometheus \<br>--config.file /etc/prometheus/prometheus.yml \<br>--storage.tsdb.path /var/lib/prometheus/ \<br>--web.console.templates=/etc/prometheus/consoles \<br>--web.console.libraries=/etc/prometheus/console_libraries<br><br>[Install]<br>WantedBy=multi-user.target</pre><p>Finally, save file dan close text editor Anda.<br>Untuk menggunakan service yang baru dibuat, reload <strong>systemd.</strong></p><pre>sudo systemctl daemon-reload</pre><p>Anda sekarang bisa Menjalankan service Prometheus menggunakan perintah berikut:</p><pre>sudo systemctl start prometheus<br>sudo systemctl status prometheus</pre><p>Outputnya memberi tahu Anda status Prometheus, pengidentifikasi proses utama (PID), penggunaan memori, dan banyak lagi.</p><p>Jika status layanan tidak aktif, ikuti petunjuk di layar dan telusuri kembali langkah-langkah sebelumnya untuk menyelesaikan masalah sebelum melanjutkan tutorial.</p><pre>Output<br>● prometheus.service - Prometheus<br>Loaded: loaded (/etc/systemd/system/prometheus.service;<br>disabled; vendor preset: enabled)<br>Active: active (running) since Fri 2017-07-21 11:40:40 UTC;<br>3s ago Main PID: 2104 (prometheus)<br>Tasks: 7<br>Memory: 13.8M<br>CPU: 470ms<br>CGroup: /system.slice/prometheus.service<br>...</pre><p>Saat Anda siap untuk melanjutkan, tekan Q untuk keluar dari perintah status.</p><p>Terakhir, aktifkan service prometheus auto start up saat system booting.</p><pre>sudo systemctl enable prometheus</pre><p>Sekarang setelah Prometheus aktif dan berjalan, kita dapat menginstal exporter tambahan untuk menghasilkan metrik tentang resource server kita.</p></div><aside class="post__aside"><div class="post__last-updated u-small">This article was updated on 4 August 2022</div><div class="post__share"><a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fteknomid.com%2Fcara-install-prometheus-di-linux-ubuntu%2F" class="js-share facebook" title="Share with Facebook" rel="nofollow noopener noreferrer" aria-label="Share with Facebook"><svg class="u-icon"><use xlink:href="https://teknomid.com/assets/svg/svg-map.svg#facebook"/></svg> </a><a href="https://twitter.com/share?url=https%3A%2F%2Fteknomid.com%2Fcara-install-prometheus-di-linux-ubuntu%2F&amp;via=teknomid&amp;text=Cara%20Install%20Prometheus%20di%20Linux%20Ubuntu" class="js-share twitter" title="Share with Twitter" rel="nofollow noopener noreferrer" aria-label="Share with Twitter"><svg class="u-icon"><use xlink:href="https://teknomid.com/assets/svg/svg-map.svg#twitter"/></svg> </a><a href="https://pinterest.com/pin/create/button/?url=https%3A%2F%2Fteknomid.com%2Fcara-install-prometheus-di-linux-ubuntu%2F&amp;media=https%3A%2F%2Fteknomid.com%2Fmedia%2Fposts%2F194%2Fprometheus-696x279.webp&amp;description=Cara%20Install%20Prometheus%20di%20Linux%20Ubuntu" class="js-share pinterest" title="Share with Pinterest" rel="nofollow noopener noreferrer" aria-label="Share with Pinterest"><svg class="u-icon"><use xlink:href="https://teknomid.com/assets/svg/svg-map.svg#pinterest"/></svg> </a><a href="https://wa.me/?text=Cara%20Install%20Prometheus%20di%20Linux%20Ubuntu https%3A%2F%2Fteknomid.com%2Fcara-install-prometheus-di-linux-ubuntu%2F" class="js-share whatsapp" rel="nofollow noopener noreferrer" title="Share with WhatsApp" aria-label="Share with WhatsApp"><svg class="u-icon"><use xlink:href="https://teknomid.com/assets/svg/svg-map.svg#whatsapp"/></svg></a></div></aside><footer class="post__footer"><ul class="post__tag box"><li><a href="https://teknomid.com/tags/cloud/" class="u-tag u-tag--1" title="CLOUD">CLOUD</a></li><li><a href="https://teknomid.com/tags/linux/" class="u-tag u-tag--1" title="LINUX">LINUX</a></li><li><a href="https://teknomid.com/tags/tutorial/" class="u-tag u-tag--1" title="TUTORIAL">TUTORIAL</a></li></ul><div class="post__bio box"><div><h4 class="h6"><a href="https://teknomid.com/authors/teknomid/" title="Teknomid">Teknomid</a></h4></div></div><nav class="post__nav box"><div class="post__nav__prev"><a href="https://teknomid.com/increase-c-drive-space-dengan-disk-management-windows-11/" class="post__nav__link" rel="prev"><img src="https://teknomid.com/media/posts/192/responsive/01-xs.webp" loading="lazy" alt="Increase C Drive Space dengan Disk Management Windows 11"><div class="u-small">Previous Post<h5>Increase C Drive Space dengan Disk Management Windows 11</h5></div></a></div><div class="post__nav__next"><a href="https://teknomid.com/cara-menghapus-cache-memori-ram-buffer-dan-swap-space-di-linux/" class="post__nav__link" rel="next"><div class="u-small">Next Post<h5>Cara Menghapus Cache Memori RAM, Buffer, dan Swap Space di Linux</h5></div><img src="https://teknomid.com/media/posts/195/responsive/free05-xs.png" loading="lazy" alt="Menghapus Cache"></a></div></nav><div class="post__related box"><h3 class="box__title">Related posts</h3><div class="post__related-wrap"><figure class="post__related-item"><a href="https://teknomid.com/cara-mudah-menghubungkan-google-form-ke-google-spreadsheet/" class="c-card__image"><img src="https://teknomid.com/media/posts/209/responsive/232-sm.png" loading="lazy" height="514" width="731" alt="Google Form ke Google Spreadsheet"></a><figcaption><h4 class="post__related-title"><a href="https://teknomid.com/cara-mudah-menghubungkan-google-form-ke-google-spreadsheet/" class="inverse">Cara Mudah Menghubungkan Google Form ke Google Spreadsheet</a></h4><time datetime="2022-07-20T21:11" class="u-small">20 July 2022</time></figcaption></figure><figure class="post__related-item"><a href="https://teknomid.com/setting-up-ipsecl2tp-vpn-server-in-linux/" class="c-card__image"><img src="https://teknomid.com/media/posts/208/responsive/Screenshot_4-sm.png" loading="lazy" height="610" width="853" alt="IPsec/L2TP VPN Server"></a><figcaption><h4 class="post__related-title"><a href="https://teknomid.com/setting-up-ipsecl2tp-vpn-server-in-linux/" class="inverse">Setting Up IPsec/L2TP VPN Server in Linux</a></h4><time datetime="2022-07-20T14:40" class="u-small">20 July 2022</time></figcaption></figure><figure class="post__related-item"><a href="https://teknomid.com/cara-mengelola-file-log-dengan-logrotate-di-ubuntu-2004/" class="c-card__image"><img src="https://teknomid.com/media/posts/196/responsive/Figure-6_large-sm.webp" loading="lazy" height="182" width="346" alt="Logrotate "></a><figcaption><h4 class="post__related-title"><a href="https://teknomid.com/cara-mengelola-file-log-dengan-logrotate-di-ubuntu-2004/" class="inverse">Cara Mengelola File Log dengan Logrotate di Ubuntu 20.04</a></h4><time datetime="2022-01-07T20:50" class="u-small">7 January 2022</time></figcaption></figure><figure class="post__related-item"><a href="https://teknomid.com/cara-menghapus-cache-memori-ram-buffer-dan-swap-space-di-linux/" class="c-card__image"><img src="https://teknomid.com/media/posts/195/responsive/free05-sm.png" loading="lazy" height="169" width="666" alt="Menghapus Cache"></a><figcaption><h4 class="post__related-title"><a href="https://teknomid.com/cara-menghapus-cache-memori-ram-buffer-dan-swap-space-di-linux/" class="inverse">Cara Menghapus Cache Memori RAM, Buffer, dan Swap Space di Linux</a></h4><time datetime="2022-01-06T21:21" class="u-small">6 January 2022</time></figcaption></figure></div></div></footer></article><div class="comments box"><h3 class="box__title">Comments</h3><div id="disqus_thread"></div><script>var disqus_config = function () {
                    this.page.url = 'https://teknomid.com/cara-install-prometheus-di-linux-ubuntu/';
                    this.page.identifier = '194';
                };
                var disqus_element_to_check = document.getElementById('disqus_thread');
            
                if ('IntersectionObserver' in window) {
                    var iObserver = new IntersectionObserver(
                        (entries, observer) => {
                            entries.forEach(entry => {
                                if (entry.intersectionRatio >= 0.1) {
                                    (function () {
                                        var d = document, s = d.createElement('script');
                                        s.src = 'https://'+''.trim()+'.disqus.com/embed.js';
                                        s.setAttribute('data-timestamp', +new Date());
                                        (d.head || d.body).appendChild(s);
                                    })();
                                    observer.unobserve(entry.target);
                                }
                            });
                        },
                        {
                            threshold: [0, 1]
                        }
                    );
            
                    iObserver.observe(disqus_element_to_check);
                } else {
                    (function () {
                        var d = document, s = d.createElement('script');
                        s.src = 'https://'+''.trim()+'.disqus.com/embed.js';
                        s.setAttribute('data-timestamp', +new Date());
                        (d.head || d.body).appendChild(s);
                    })();
                }</script><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript></div></main><footer class="footer"><a class="footer__logo" href="https://teknomid.com/"><img src="https://teknomid.com/media/website/Teknomid.png" alt="Portal Teknologi"></a><nav><ul class="footer__nav"></ul></nav><div class="footer__follow"><a href="https://www.facebook.com/teknomidID/" aria-label="Facebook"><svg><use xlink:href="https://teknomid.com/assets/svg/svg-map.svg#facebook"/></svg> </a><a href="https://twitter.com/Teknomid_com" aria-label="Twitter"><svg><use xlink:href="https://teknomid.com/assets/svg/svg-map.svg#twitter"/></svg> </a><a href="https://id.pinterest.com/teknomid/" aria-label="Pinterest"><svg><use xlink:href="https://teknomid.com/assets/svg/svg-map.svg#pinterest"/></svg> </a><a href="https://www.youtube.com/channel/UCmg7X0Q-1tZpL7oNau2_iJA" aria-label="Youtube"><svg><use xlink:href="https://teknomid.com/assets/svg/svg-map.svg#youtube"/></svg></a></div><div class="footer__copyright"><p><a href="https://teknomid.com/tentang-2" title="About" target="_blank" rel="noopener">About</a> <a href="https://teknomid.com/kontak-2" title="Contact" target="_blank" rel="noopener">Contact</a> <a href="https://teknomid.com/kebijakan-privasi-2" title="Privacy" target="_blank" rel="noopener">Privacy</a> <a href="https://teknomid.com/disclaimer-2" title="Disclaimer" target="_blank" rel="noopener">Disclaimer</a></p>Copyright &copy; 2022 Portal Teknologi.</div></footer></div><script>window.publiiThemeMenuConfig = {    
        mobileMenuMode: 'sidebar',
        animationSpeed: 300,
        submenuWidth: 'auto',
        doubleClickTime: 500,
        mobileMenuExpandableSubmenus: true, 
        relatedContainerForOverlayMenuSelector: '.navbar',
   };</script><script defer="defer" src="https://teknomid.com/assets/js/scripts.min.js?v=bb66f1d815180573784f8434c8f0bf78"></script><script>var images = document.querySelectorAll('img[loading]');

      for (var i = 0; i < images.length; i++) {
         if (images[i].complete) {
               images[i].classList.add('is-loaded');
         } else {
               images[i].addEventListener('load', function () {
                  this.classList.add('is-loaded');
               }, false);
         }
      }</script><div class="pcb" data-behaviour="badge" data-behaviour-link="#cookie-settings" data-revision="1" data-config-ttl="90" data-debug-mode="false"><div role="dialog" aria-modal="true" aria-hidden="true" aria-labelledby="pcb-title" aria-describedby="pcb-txt" class="pcb__banner pcb__banner--left"><div class="pcb__inner"><div id="pcb-title" role="heading" class="pcb__title">This website uses cookies</div><div id="pcb-txt" class="pcb__txt">Select which cookies to opt-in to via the checkboxes below; our website uses cookies to examine site traffic and user activity while on our site, for marketing, and to provide social media functionality. <a href="https://teknomid.com/kebijakan-privasi-2/">More details...</a></div><div class="pcb__buttons"><button type="button" class="pcb__btn pcb__btn--solid pcb__btn--accept">Save</button></div></div></div><button class="pcb__badge" aria-label="Cookie Policy" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" width="40" height="40" viewBox="0 0 23 23" fill="currentColor"><path d="M21.41 12.71c-.08-.01-.15 0-.22 0h-.03c-.03 0-.05 0-.08.01-.07 0-.13.01-.19.04-.52.21-1.44.19-2.02-.22-.44-.31-.65-.83-.62-1.53a.758.758 0 0 0-.27-.61.73.73 0 0 0-.65-.14c-1.98.51-3.49.23-4.26-.78-.82-1.08-.73-2.89.24-4.49.14-.23.14-.52 0-.75a.756.756 0 0 0-.67-.36c-.64.03-1.11-.1-1.31-.35-.19-.26-.13-.71-.01-1.29.04-.18.06-.38.03-.59-.05-.4-.4-.7-.81-.66C5.1 1.54 1 6.04 1 11.48 1 17.28 5.75 22 11.6 22c5.02 0 9.39-3.54 10.39-8.42.08-.4-.18-.78-.58-.87Zm-9.81 7.82c-5.03 0-9.12-4.06-9.12-9.06 0-4.34 3.05-8 7.25-8.86-.08.7.05 1.33.42 1.81.24.32.66.67 1.38.84-.76 1.86-.65 3.78.36 5.11.61.81 2.03 2 4.95 1.51.18.96.71 1.54 1.18 1.87.62.43 1.38.62 2.1.62.05 0 .09 0 .13-.01-1.23 3.64-4.7 6.18-8.64 6.18ZM13 17c0 .55-.45 1-1 1s-1-.45-1-1 .45-1 1-1 1 .45 1 1Zm5.29-12.3a.99.99 0 0 1-.29-.71c0-.55.45-.99 1-.99a1 1 0 0 1 .71.3c.19.19.29.44.29.71 0 .55-.45.99-1 .99a1 1 0 0 1-.71-.3ZM9 13.5c0 .83-.67 1.5-1.5 1.5S6 14.33 6 13.5 6.67 12 7.5 12s1.5.67 1.5 1.5Zm3.25.81a.744.744 0 0 1-.06-1.05c.28-.32.75-.34 1.05-.06.31.28.33.75.05 1.06-.15.16-.35.25-.56.25-.18 0-.36-.06-.5-.19ZM8.68 7.26c.41.37.44 1 .07 1.41-.2.22-.47.33-.75.33a.96.96 0 0 1-.67-.26c-.41-.37-.44-1-.07-1.41.37-.42 1-.45 1.41-.08Zm11.48 1.88c.18-.19.52-.19.7 0 .05.04.09.1.11.16.03.06.04.12.04.19 0 .13-.05.26-.15.35-.09.1-.22.15-.35.15s-.26-.05-.35-.15a.355.355 0 0 1-.11-.16.433.433 0 0 1-.04-.19c0-.13.05-.26.15-.35Zm-4.93-1.86a.75.75 0 1 1 1.059-1.06.75.75 0 0 1-1.059 1.06Z"/></svg></button></div><script>(function(win) {
    if (!document.querySelector('.pcb')) {
        return;
    }

    var cbConfig = {
        behaviour: document.querySelector('.pcb').getAttribute('data-behaviour'),
        behaviourLink: document.querySelector('.pcb').getAttribute('data-behaviour-link'),
        revision: document.querySelector('.pcb').getAttribute('data-revision'),
        configTTL: parseInt(document.querySelector('.pcb').getAttribute('data-config-ttl'), 10),
        debugMode: document.querySelector('.pcb').getAttribute('data-debug-mode') === 'true',
        initialState: null,
        previouslyAccepted: []
    };

    var cbUI = {
        wrapper: document.querySelector('.pcb'),
        banner: {
            element: null,
            btnAccept: null,
            btnReject: null,
            btnConfigure: null
        },
        popup: {
            element: null,
            btnClose: null,
            btnSave: null,
            btnAccept: null,
            btnReject: null,
            checkboxes: null,
        },
        overlay: null,
        badge: null,
        blockedScripts: document.querySelectorAll('script[type^="gdpr-blocker/"]'),
        triggerLinks: cbConfig.behaviourLink ? document.querySelectorAll('a[href*="' + cbConfig.behaviourLink + '"]') : null
    };

    function initUI () {
        // setup banner elements
        cbUI.banner.element = cbUI.wrapper.querySelector('.pcb__banner');
        cbUI.banner.btnAccept = cbUI.banner.element.querySelector('.pcb__btn--accept');
        cbUI.banner.btnReject = cbUI.banner.element.querySelector('.pcb__btn--reject');
        cbUI.banner.btnConfigure = cbUI.banner.element.querySelector('.pcb__btn--configure');

        // setup popup elements
        if (cbUI.wrapper.querySelector('.pcb__popup')) {
            cbUI.popup.element = cbUI.wrapper.querySelector('.pcb__popup');
            cbUI.popup.btnClose = cbUI.wrapper.querySelector('.pcb__popup__close');
            cbUI.popup.btnSave = cbUI.popup.element.querySelector('.pcb__btn--save');
            cbUI.popup.btnAccept = cbUI.popup.element.querySelector('.pcb__btn--accept');
            cbUI.popup.btnReject = cbUI.popup.element.querySelector('.pcb__btn--reject');
            cbUI.popup.checkboxes = cbUI.popup.element.querySelector('input[type="checkbox"]');
            // setup overlay
            cbUI.overlay = cbUI.wrapper.querySelector('.pcb__overlay');
        }

        cbUI.badge = cbUI.wrapper.querySelector('.pcb__badge');

        if (cbConfig.behaviour.indexOf('link') > -1) {
            for (var i = 0; i < cbUI.triggerLinks.length; i++) {
                cbUI.triggerLinks[i].addEventListener('click', function(e) {
                    e.preventDefault();
                    showBannerOrPopup();
                });
            }
        }
    }

    function initState () {
        var lsKeyName = getConfigName();
        var currentConfig = localStorage.getItem(lsKeyName);
        var configIsFresh = checkIfConfigIsFresh();

        if (!configIsFresh || currentConfig === null) {
            if (cbConfig.debugMode) {
                console.log('🍪 Config not found, or configuration expired');
            }

            showBanner();
        } else if (typeof currentConfig === 'string') {
            if (cbConfig.debugMode) {
                console.log('🍪 Config founded');
            }

            showBadge();

            if (cbUI.popup.element) {
                var allowedGroups = currentConfig.split(',');
                var checkedCheckboxes = cbUI.popup.element.querySelectorAll('input[type="checkbox"]:checked');

                for (var j = 0; j < checkedCheckboxes.length; j++) {
                    var name = checkedCheckboxes[j].getAttribute('data-group-name');

                    if (name && name !== '-' && allowedGroups.indexOf(name) === -1) {
                        checkedCheckboxes[j].checked = false;
                    }
                }

                for (var i = 0; i < allowedGroups.length; i++) {
                    var checkbox = cbUI.popup.element.querySelector('input[type="checkbox"][data-group-name="' + allowedGroups[i] + '"]');

                    if (checkbox) {
                        checkbox.checked = true;
                    }

                    allowCookieGroup(allowedGroups[i]);
                }
            }
        }

        setTimeout(function () {
            cbConfig.initialState = getInitialStateOfConsents();
        }, 0);
    }

    function checkIfConfigIsFresh () {
        var lastConfigSave = localStorage.getItem('publii-gdpr-cookies-config-save-date');

        if (lastConfigSave === null) {
            return false;
        }

        lastConfigSave = parseInt(lastConfigSave, 10);

        if (lastConfigSave === 0) {
            return true;
        }

        if (+new Date() - lastConfigSave < cbConfig.configTTL * 24 * 60 * 60 * 1000) {
            return true;
        }

        return false;
    }

    function initBannerEvents () {
        cbUI.banner.btnAccept.addEventListener('click', function (e) {
            e.preventDefault();
            acceptAllCookies('banner');
            showBadge();
        }, false);

        if (cbUI.banner.btnReject) {
            cbUI.banner.btnReject.addEventListener('click', function (e) {
                e.preventDefault();
                rejectAllCookies();
                showBadge();
            }, false);
        }

        if (cbUI.banner.btnConfigure) {
            cbUI.banner.btnConfigure.addEventListener('click', function (e) {
                e.preventDefault();
                hideBanner();
                showAdvancedPopup();
                showBadge();
            }, false);
        }
    }

    function initPopupEvents () {
        if (!cbUI.popup.element) {
            return;
        }

        cbUI.overlay.addEventListener('click', function (e) {
            hideAdvancedPopup();
        }, false);

        cbUI.popup.element.addEventListener('click', function (e) {
            e.stopPropagation();
        }, false);

        cbUI.popup.btnAccept.addEventListener('click', function (e) {
            e.preventDefault();
            acceptAllCookies('popup');
        }, false);

        cbUI.popup.btnReject.addEventListener('click', function (e) {
            e.preventDefault();
            rejectAllCookies();
        }, false);

        cbUI.popup.btnSave.addEventListener('click', function (e) {
            e.preventDefault();
            saveConfiguration();
        }, false);

        cbUI.popup.btnClose.addEventListener('click', function (e) {
            e.preventDefault();
            hideAdvancedPopup();
        }, false);
    }

    function initBadgeEvents () {
        if (!cbUI.badge) {
            return;
        }

        cbUI.badge.addEventListener('click', function (e) {
            showBannerOrPopup();
        }, false);
    }

    initUI();
    initState();
    initBannerEvents();
    initPopupEvents();
    initBadgeEvents();

    /**
     * API
     */
    function addScript (src, inline) {
        var newScript = document.createElement('script');

        if (src) {
            newScript.setAttribute('src', src);
        }

        if (inline) {
            newScript.text = inline;
        }

        document.body.appendChild(newScript);
    }

    function allowCookieGroup (allowedGroup) {
        var scripts = document.querySelectorAll('script[type="gdpr-blocker/' + allowedGroup + '"]');
        cbConfig.previouslyAccepted.push(allowedGroup);
    
        for (var j = 0; j < scripts.length; j++) {
            addScript(scripts[j].src, scripts[j].text);
        }

        var groupEvent = new Event('publii-cookie-banner-unblock-' + allowedGroup);
        document.body.dispatchEvent(groupEvent);
        unlockEmbeds(allowedGroup);

        if (cbConfig.debugMode) {
            console.log('🍪 Allowed group: ' + allowedGroup);
        }
    }

    function showBannerOrPopup () {
        if (cbUI.popup.element) {
            showAdvancedPopup();
        } else {
            showBanner();
        }
    }

    function showAdvancedPopup () {
        cbUI.popup.element.classList.add('is-visible');
        cbUI.overlay.classList.add('is-visible');
        cbUI.popup.element.setAttribute('aria-hidden', 'false');
        cbUI.overlay.setAttribute('aria-hidden', 'false');
    }

    function hideAdvancedPopup () {
        cbUI.popup.element.classList.remove('is-visible');
        cbUI.overlay.classList.remove('is-visible');
        cbUI.popup.element.setAttribute('aria-hidden', 'true');
        cbUI.overlay.setAttribute('aria-hidden', 'true');
    }

    function showBanner () {
        cbUI.banner.element.classList.add('is-visible');
        cbUI.banner.element.setAttribute('aria-hidden', 'false');
    }

    function hideBanner () {
        cbUI.banner.element.classList.remove('is-visible');
        cbUI.banner.element.setAttribute('aria-hidden', 'true');
    }

    function showBadge () {
        if (!cbUI.badge) {
            return;
        }

        cbUI.badge.classList.add('is-visible');
        cbUI.badge.setAttribute('aria-hidden', 'false');
    }

    function getConfigName () {
        var lsKeyName = 'publii-gdpr-allowed-cookies';

        if (cbConfig.revision) {
            lsKeyName = lsKeyName + '-v' + parseInt(cbConfig.revision, 10);
        }

        return lsKeyName;
    }

    function storeConfiguration (allowedGroups) {
        var lsKeyName = getConfigName();
        var dataToStore = allowedGroups.join(',');
        localStorage.setItem(lsKeyName, dataToStore);

        if (cbConfig.configTTL === 0) {
            localStorage.setItem('publii-gdpr-cookies-config-save-date', 0);

            if (cbConfig.debugMode) {
                console.log('🍪 Store never expiring configuration');
            }
        } else {
            localStorage.setItem('publii-gdpr-cookies-config-save-date', +new Date());
        }
    }

    function getInitialStateOfConsents () {
        if (!cbUI.popup.element) {
            return [];
        }

        var checkedGroups = cbUI.popup.element.querySelectorAll('input[type="checkbox"]:checked');
        var groups = [];

        for (var i = 0; i < checkedGroups.length; i++) {
            var allowedGroup = checkedGroups[i].getAttribute('data-group-name');

            if (allowedGroup !== '') {
                groups.push(allowedGroup);
            }
        }

        if (cbConfig.debugMode) {
            console.log('🍪 Initial state: ' + groups.join(', '));
        }

        return groups;
    }

    function getCurrentStateOfConsents () {
        if (!cbUI.popup.element) {
            return [];
        }

        var checkedGroups = cbUI.popup.element.querySelectorAll('input[type="checkbox"]:checked');
        var groups = [];

        for (var i = 0; i < checkedGroups.length; i++) {
            var allowedGroup = checkedGroups[i].getAttribute('data-group-name');

            if (allowedGroup !== '') {
                groups.push(allowedGroup);
            }
        }

        if (cbConfig.debugMode) {
            console.log('🍪 State to save: ' + groups.join(', '));
        }

        return groups;
    }

    function getAllGroups () {
        if (!cbUI.popup.element) {
            return [];
        }

        var checkedGroups = cbUI.popup.element.querySelectorAll('input[type="checkbox"]');
        var groups = [];

        for (var i = 0; i < checkedGroups.length; i++) {
            var allowedGroup = checkedGroups[i].getAttribute('data-group-name');

            if (allowedGroup !== '') {
                groups.push(allowedGroup);
            }
        }

        return groups;
    }

    function acceptAllCookies (source) {
        var groupsToAccept = getAllGroups();
        storeConfiguration(groupsToAccept);

        for (var i = 0; i < groupsToAccept.length; i++) {
            var group = groupsToAccept[i];

            if (cbConfig.initialState.indexOf(group) > -1 || cbConfig.previouslyAccepted.indexOf(group) > -1) {
                if (cbConfig.debugMode) {
                    console.log('🍪 Skip previously activated group: ' + group);
                }

                continue;
            }

            allowCookieGroup(group);
        }

        if (cbUI.popup.element) {
            var checkboxesToCheck = cbUI.popup.element.querySelectorAll('input[type="checkbox"]');

            for (var j = 0; j < checkboxesToCheck.length; j++) {
                checkboxesToCheck[j].checked = true;
            }
        }

        if (cbConfig.debugMode) {
            console.log('🍪 Accept all cookies: ', groupsToAccept.join(', '));
        }

        if (source === 'popup') {
            hideAdvancedPopup();
        } else if (source === 'banner') {
            hideBanner();
        }
    }

    function rejectAllCookies () {
        if (cbConfig.debugMode) {
            console.log('🍪 Reject all cookies');
        }

        storeConfiguration([]);
        setTimeout(function () {
            window.location.reload();
        }, 100);
    }

    function saveConfiguration () {
        var groupsToAccept = getCurrentStateOfConsents();
        storeConfiguration(groupsToAccept);

        if (cbConfig.debugMode) {
            console.log('🍪 Save new config: ', groupsToAccept.join(', '));
        }

        if (reloadIsNeeded(groupsToAccept)) {
            setTimeout(function () {
                window.location.reload();
            }, 100);
            return;
        }

        for (var i = 0; i < groupsToAccept.length; i++) {
            var group = groupsToAccept[i];

            if (cbConfig.initialState.indexOf(group) > -1 || cbConfig.previouslyAccepted.indexOf(group) > -1) {
                if (cbConfig.debugMode) {
                    console.log('🍪 Skip previously activated group: ' + group);
                }

                continue;
            }

            allowCookieGroup(group);
        }

        hideAdvancedPopup();
    }

    function reloadIsNeeded (groupsToAccept) {
        // check if user rejected consent for initial groups
        var initialGroups = cbConfig.initialState;
        var previouslyAcceptedGroups = cbConfig.previouslyAccepted;
        var groupsToCheck = initialGroups.concat(previouslyAcceptedGroups);

        for (var i = 0; i < groupsToCheck.length; i++) {
            var groupToCheck = groupsToCheck[i];

            if (groupsToAccept.indexOf(groupToCheck) === -1) {
                if (cbConfig.debugMode) {
                    console.log('🍪 Reload is needed due lack of: ', groupToCheck);
                }

                return true;
            }
        }

        return false;
    }

    function unlockEmbeds (cookieGroup) {
        var iframesToUnlock = document.querySelectorAll('.pec-wrapper[data-consent-group-id="' + cookieGroup + '"]');

        for (var i = 0; i < iframesToUnlock.length; i++) {
            var iframeWrapper = iframesToUnlock[i];
            iframeWrapper.querySelector('.pec-overlay').classList.remove('is-active');
            iframeWrapper.querySelector('.pec-overlay').setAttribute('aria-hidden', 'true');
            var iframe = iframeWrapper.querySelector('iframe');
            iframe.setAttribute('src', iframe.getAttribute('data-consent-src'));
        }
    }

    win.publiiEmbedConsentGiven = function (cookieGroup) {
        // it will unlock embeds
        allowCookieGroup(cookieGroup);

        var checkbox = cbUI.popup.element.querySelector('input[type="checkbox"][data-group-name="' + cookieGroup + '"]');

        if (checkbox) {
            checkbox.checked = true;
        }

        var groupsToAccept = getCurrentStateOfConsents();
        storeConfiguration(groupsToAccept);

        if (cbConfig.debugMode) {
            console.log('🍪 Save new config: ', groupsToAccept.join(', '));
        }
    }
})(window);</script></body></html>